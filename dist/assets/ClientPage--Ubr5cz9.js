import{r as h,s as H,j as e,l as q,m as M,n as k,o as r,p as V,q as t,D as u,Y as U,a as y,b as j,d as b,e as g,B as s,Z as $,_ as J,W as K}from"./index-DLRFQSPt.js";import{u as Q}from"./useStudents-BZmo_OJ8.js";import{b as W,c as z,U as f}from"./useUploadFile-l5fIrPqO.js";import{C as Y}from"./camera-AxXYECLG.js";import{D as Z,F as X}from"./file-spreadsheet-F0wcHJAc.js";function re({onEditClient:N,onAddClient:w}){const[d,F]=h.useState(null),P=H(),[S,x]=h.useState(!1),[c,C]=h.useState(null),[B,m]=h.useState(!1),{data:i}=Q(),E=W(),T=l=>{F({name:l,hasPhoto:!1,photoUrl:void 0})},O=()=>{const l=`Name,Age,Gender,ID Number,Primary Diagnosis,Secondary Diagnosis,Date of Enrollment,Email,DOB,Guardian Name,Guardian Contact,Class Name
John Doe,25,M,CL001,Speech and Language,,2024-01-15,john@example.com,1999-03-15,Jane Doe,+65 9123 4567,Class A`,o=new Blob([l],{type:"text/csv"}),a=window.URL.createObjectURL(o),n=document.createElement("a");n.href=a,n.download="clients_template.csv",n.click(),window.URL.revokeObjectURL(a)},D=()=>{const l=document.createElement("input");l.type="file",l.accept=".xlsx,.xls,.csv",l.style.display="none",l.onchange=o=>{var n;const a=(n=o.target.files)==null?void 0:n[0];a&&(console.log("Excel file selected:",a.name),C(a))},document.body.appendChild(l),l.click(),document.body.removeChild(l)},A=()=>{c&&(console.log("Processing client bulk upload for file:",c.name),c&&E.mutate(c),C(null),x(!1))},_=(l,o)=>{o.stopPropagation(),N&&N(l)},G=()=>{w&&w()},I=()=>{C(null),x(!1)},R=z(),L=l=>{const o=document.createElement("input");o.type="file",o.accept="image/*",o.style.display="none",o.onchange=a=>{var v;const n=(v=a.target.files)==null?void 0:v[0];n&&R.mutate({studentId:l,file:n},{onSuccess:p=>{console.log("Uploaded:",p),m(!0),P.invalidateQueries({queryKey:["allstudents"]})},onError:p=>{console.error("Upload failed",p)}})},document.body.appendChild(o),o.click(),document.body.removeChild(o)};return e.jsx("div",{className:"flex-1 px-6 py-8",style:{backgroundColor:"#F8F9FA"},children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("h2",{className:"text-2xl font-bold",style:{color:"#3C3C3C"},children:"Clients"})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(q,{children:[e.jsx(M,{children:e.jsxs(k,{className:"border-b-2",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:[e.jsx(r,{style:{color:"#3C3C3C"},children:"No."}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Name"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Age"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Gender"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"ID"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Primary Diagnosis"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Secondary Diagnosis"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Date of Enrollment"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Photo"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Edit"})]})}),e.jsx(V,{children:i==null?void 0:i.map((l,o)=>e.jsxs(k,{className:`${o<i.length-1?"border-b":""} hover:bg-gray-50 transition-colors`,style:{borderColor:"#BDC3C7"},children:[e.jsx(t,{style:{color:"#3C3C3C"},children:o+1}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.name}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.chronological_age}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.gender}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.id_number}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.primary_diagnosis}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.secondary_diagnosis}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.date_of_enrollment}),e.jsx(t,{className:"text-center",children:e.jsxs(u,{children:[e.jsx(U,{asChild:!0,children:e.jsx("button",{className:"w-10 h-8 border border-red-500 bg-red-50 flex items-center justify-center hover:bg-red-100 transition-colors rounded",onClick:()=>T(l.name),title:`View/Upload photo for ${l.name}`,children:e.jsx(Y,{className:"w-4 h-4",style:{color:"#DC3545"}})})}),e.jsx(y,{className:"max-w-md mx-auto bg-white rounded-lg shadow-xl border-2 p-6",style:{borderColor:"#BDC3C7",backgroundColor:"white"},children:d&&e.jsxs(e.Fragment,{children:[e.jsxs(j,{className:"pb-4 text-left",children:[e.jsxs(b,{className:"text-lg font-bold",style:{color:"#3C3C3C"},children:[d.name," - Photo"]}),e.jsxs(g,{className:"text-sm mt-2",style:{color:"#6C757D"},children:["View the photo for ",d.name,". Click outside to close this dialog."]})]}),e.jsx("div",{className:"flex justify-center py-6",children:e.jsx("div",{className:"rounded-lg flex items-center justify-center overflow-hidden",style:{backgroundColor:"#E8F4F8"},children:l.photo?e.jsx("img",{src:l.photo,alt:`Photo of ${l.name}`,className:"max-w-full h-auto rounded-lg",style:{maxHeight:"300px",maxWidth:"300px"}},l.photo):e.jsx("img",{src:"/placeholder-user.png",alt:"No photo available",className:"max-w-full h-auto",style:{maxHeight:"300px"}})})}),e.jsxs("div",{className:"flex justify-center space-x-3 pt-4",children:[e.jsxs(s,{className:"px-4 py-2 rounded-lg transition-all duration-200 hover:opacity-90",onClick:()=>L(l.id),style:{backgroundColor:"#e65039",color:"white",border:"none"},children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Upload New Photo"]}),d.hasPhoto&&e.jsx(s,{variant:"outline",className:"px-4 py-2 rounded-lg border-2 transition-all duration-200 hover:opacity-90",style:{borderColor:"#DC3545",color:"#DC3545",backgroundColor:"white"},children:"Remove Photo"})]})]})})]})}),e.jsx(t,{children:e.jsx(s,{onClick:a=>_(l,a),className:"p-1 border rounded transition-all duration-200 hover:opacity-90",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:e.jsx($,{className:"w-4 h-4"})})})]},l.id))})]})})}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsxs(u,{open:S,onOpenChange:x,children:[e.jsx(U,{asChild:!0,children:e.jsxs(s,{className:"flex items-center space-x-2 px-6 py-2 transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:"Upload"})]})}),e.jsxs(y,{className:"max-w-md",style:{backgroundColor:"white"},children:[e.jsxs(j,{children:[e.jsx(b,{className:"text-lg font-bold",style:{color:"#3C3C3C"},children:"Bulk Upload Clients"}),e.jsx(g,{className:"text-sm",style:{color:"#6C757D"},children:"Upload multiple clients at once using an Excel file. Follow the two-step process below."})]}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",style:{color:"#3C3C3C"},children:"Step 1: Download Template"}),e.jsxs(s,{onClick:O,className:"w-full flex items-center space-x-2 border-2 px-4 py-2 transition-all duration-200 hover:bg-blue-50",style:{backgroundColor:"white",borderColor:"#e65039",color:"#e65039"},children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{children:"Download Excel Template"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",style:{color:"#3C3C3C"},children:"Step 2: Upload Completed File"}),c?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 border rounded-lg",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"w-5 h-5",style:{color:"#e65039"}}),e.jsx("span",{className:"text-sm font-medium",style:{color:"#3C3C3C"},children:c.name})]}),e.jsxs("p",{className:"text-xs mt-1",style:{color:"#6C757D"},children:[(c.size/1024).toFixed(1)," KB"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(s,{onClick:D,className:"flex-1 border-2 px-4 py-2 transition-all duration-200 hover:bg-blue-50",style:{backgroundColor:"white",borderColor:"#e65039",color:"#e65039"},children:"Change File"}),e.jsx(s,{onClick:A,className:"flex-1 px-4 py-2 transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:"Upload"})]})]}):e.jsxs(s,{onClick:D,className:"w-full border-2 border-dashed px-6 py-6 transition-all duration-200 hover:bg-blue-50 flex flex-col items-center justify-center space-y-3 min-h-[120px]",style:{backgroundColor:"white",borderColor:"#e65039",color:"#e65039"},children:[e.jsx(f,{className:"w-6 h-6 flex-shrink-0"}),e.jsxs("div",{className:"text-center space-y-1 max-w-full",children:[e.jsx("p",{className:"font-medium text-sm leading-tight",children:"Choose Excel File"}),e.jsx("p",{className:"text-xs leading-tight break-words",style:{color:"#6C757D"},children:"Supports .xlsx, .xls, .csv files"})]})]})]}),e.jsx("div",{className:"bg-yellow-100 p-3 border-l-4",style:{borderColor:"#FF8C42"},children:e.jsxs("p",{className:"text-xs",style:{color:"#3C3C3C"},children:[e.jsx("strong",{children:"Note:"})," The Excel file should contain columns for Name, Age, Gender, ID Number, Primary Diagnosis, Secondary Diagnosis, Date of Enrollment, Email, DOB, Guardian Name, and Guardian Contact."]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(J,{asChild:!0,children:e.jsx(s,{onClick:I,className:"px-4 py-2",style:{backgroundColor:"#BDC3C7",color:"white",border:"none"},children:"Cancel"})})})]})]}),e.jsx(u,{open:B,onOpenChange:m,children:e.jsxs(y,{className:"max-w-md bg-white rounded-lg border-2",style:{backgroundColor:"white",borderColor:"#BDC3C7"},children:[e.jsxs(j,{children:[e.jsx(b,{style:{color:"#3C3C3C"},children:"Photo Update"}),e.jsx(g,{style:{color:"#6C757D"},children:"Photo has been successfully updated."})]}),e.jsx("div",{className:"flex justify-end space-x-3 pt-2",children:e.jsx(s,{onClick:()=>m(!1),className:"px-4 py-2 border-2 transition-all duration-200",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Ok"})})]})}),e.jsxs(s,{onClick:G,className:"flex items-center space-x-2 px-6 py-2 transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Clients"})]})]})]})})}export{re as ClientPage};
