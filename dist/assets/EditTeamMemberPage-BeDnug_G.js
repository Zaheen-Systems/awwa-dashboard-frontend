import{c as ot,r as a,X as Fe,y as nt,j as t,Y as lt,z as at,A as L,Z as Me,P as I,F as oe,_ as Te,G as Ue,$ as st,a0 as ct,a1 as it,a2 as dt,a3 as ut,a4 as pt,a5 as mt,a6 as ft,a7 as ht,w as ue,a8 as gt,a9 as vt,aa as Ct,ab as xt,ac as ne,M as bt,t as yt,B as F,L as _,I as $,S as Ee,f as Se,g as Re,h as _e,i as te,ad as jt,D as fe,a as he,b as ge,d as ve,e as Ce}from"./index-Bnf_FfGu.js";import{C as wt}from"./checkbox-CVjRHtEi.js";import{c as kt,a as Nt,d as Pt,e as Dt}from"./useUsers-DeWzG1UU.js";import{a as Et,U as St}from"./useUploadFile-CerTmN_T.js";import{T as Rt}from"./trash-2-Dl4HnoQ7.js";import{U as _t}from"./user-C53dMYct.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=ot("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);var pe="Popover",[Be,Sr]=at(pe,[Fe]),le=Fe(),[It,U]=Be(pe),$e=e=>{const{__scopePopover:n,children:r,open:o,defaultOpen:s,onOpenChange:c,modal:i=!1}=e,p=le(n),h=a.useRef(null),[d,g]=a.useState(!1),[x,j]=nt({prop:o,defaultProp:s??!1,onChange:c,caller:pe});return t.jsx(lt,{...p,children:t.jsx(It,{scope:n,contentId:L(),triggerRef:h,open:x,onOpenChange:j,onOpenToggle:a.useCallback(()=>j(k=>!k),[j]),hasCustomAnchor:d,onCustomAnchorAdd:a.useCallback(()=>g(!0),[]),onCustomAnchorRemove:a.useCallback(()=>g(!1),[]),modal:i,children:r})})};$e.displayName=pe;var Le="PopoverAnchor",Ot=a.forwardRef((e,n)=>{const{__scopePopover:r,...o}=e,s=U(Le,r),c=le(r),{onCustomAnchorAdd:i,onCustomAnchorRemove:p}=s;return a.useEffect(()=>(i(),()=>p()),[i,p]),t.jsx(Te,{...c,...o,ref:n})});Ot.displayName=Le;var qe="PopoverTrigger",ze=a.forwardRef((e,n)=>{const{__scopePopover:r,...o}=e,s=U(qe,r),c=le(r),i=Me(n,s.triggerRef),p=t.jsx(I.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":We(s.open),...o,ref:i,onClick:oe(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?p:t.jsx(Te,{asChild:!0,...c,children:p})});ze.displayName=qe;var ke="PopoverPortal",[Ft,Mt]=Be(ke,{forceMount:void 0}),Ke=e=>{const{__scopePopover:n,forceMount:r,children:o,container:s}=e,c=U(ke,n);return t.jsx(Ft,{scope:n,forceMount:r,children:t.jsx(Ue,{present:r||c.open,children:t.jsx(st,{asChild:!0,container:s,children:o})})})};Ke.displayName=ke;var Q="PopoverContent",Ve=a.forwardRef((e,n)=>{const r=Mt(Q,e.__scopePopover),{forceMount:o=r.forceMount,...s}=e,c=U(Q,e.__scopePopover);return t.jsx(Ue,{present:o||c.open,children:c.modal?t.jsx(Ut,{...s,ref:n}):t.jsx(Bt,{...s,ref:n})})});Ve.displayName=Q;var Tt=dt("PopoverContent.RemoveScroll"),Ut=a.forwardRef((e,n)=>{const r=U(Q,e.__scopePopover),o=a.useRef(null),s=Me(n,o),c=a.useRef(!1);return a.useEffect(()=>{const i=o.current;if(i)return ct(i)},[]),t.jsx(it,{as:Tt,allowPinchZoom:!0,children:t.jsx(Ge,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:oe(e.onCloseAutoFocus,i=>{var p;i.preventDefault(),c.current||(p=r.triggerRef.current)==null||p.focus()}),onPointerDownOutside:oe(e.onPointerDownOutside,i=>{const p=i.detail.originalEvent,h=p.button===0&&p.ctrlKey===!0,d=p.button===2||h;c.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:oe(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),Bt=a.forwardRef((e,n)=>{const r=U(Q,e.__scopePopover),o=a.useRef(!1),s=a.useRef(!1);return t.jsx(Ge,{...e,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var i,p;(i=e.onCloseAutoFocus)==null||i.call(e,c),c.defaultPrevented||(o.current||(p=r.triggerRef.current)==null||p.focus(),c.preventDefault()),o.current=!1,s.current=!1},onInteractOutside:c=>{var h,d;(h=e.onInteractOutside)==null||h.call(e,c),c.defaultPrevented||(o.current=!0,c.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const i=c.target;((d=r.triggerRef.current)==null?void 0:d.contains(i))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&s.current&&c.preventDefault()}})}),Ge=a.forwardRef((e,n)=>{const{__scopePopover:r,trapFocus:o,onOpenAutoFocus:s,onCloseAutoFocus:c,disableOutsidePointerEvents:i,onEscapeKeyDown:p,onPointerDownOutside:h,onFocusOutside:d,onInteractOutside:g,...x}=e,j=U(Q,r),k=le(r);return ut(),t.jsx(pt,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:s,onUnmountAutoFocus:c,children:t.jsx(mt,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:g,onEscapeKeyDown:p,onPointerDownOutside:h,onFocusOutside:d,onDismiss:()=>j.onOpenChange(!1),children:t.jsx(ft,{"data-state":We(j.open),role:"dialog",id:j.contentId,...k,...x,ref:n,style:{...x.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),He="PopoverClose",$t=a.forwardRef((e,n)=>{const{__scopePopover:r,...o}=e,s=U(He,r);return t.jsx(I.button,{type:"button",...o,ref:n,onClick:oe(e.onClick,()=>s.onOpenChange(!1))})});$t.displayName=He;var Lt="PopoverArrow",qt=a.forwardRef((e,n)=>{const{__scopePopover:r,...o}=e,s=le(r);return t.jsx(ht,{...s,...o,ref:n})});qt.displayName=Lt;function We(e){return e?"open":"closed"}var zt=$e,Kt=ze,Vt=Ke,Gt=Ve;function Ht({...e}){return t.jsx(zt,{"data-slot":"popover",...e})}function Wt({...e}){return t.jsx(Kt,{"data-slot":"popover-trigger",...e})}function Qt({className:e,align:n="center",sideOffset:r=4,...o}){return t.jsx(Vt,{children:t.jsx(Gt,{"data-slot":"popover-content",align:n,sideOffset:r,className:ue("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...o})})}var Ae=1,Xt=.9,Yt=.8,Zt=.17,xe=.1,be=.999,Jt=.9999,er=.99,tr=/[\\\/_+.#"@\[\(\{&]/,rr=/[\\\/_+.#"@\[\(\{&]/g,or=/[\s-]/,Qe=/[\s-]/g;function je(e,n,r,o,s,c,i){if(c===n.length)return s===e.length?Ae:er;var p=`${s},${c}`;if(i[p]!==void 0)return i[p];for(var h=o.charAt(c),d=r.indexOf(h,s),g=0,x,j,k,A;d>=0;)x=je(e,n,r,o,d+1,c+1,i),x>g&&(d===s?x*=Ae:tr.test(e.charAt(d-1))?(x*=Yt,k=e.slice(s,d-1).match(rr),k&&s>0&&(x*=Math.pow(be,k.length))):or.test(e.charAt(d-1))?(x*=Xt,A=e.slice(s,d-1).match(Qe),A&&s>0&&(x*=Math.pow(be,A.length))):(x*=Zt,s>0&&(x*=Math.pow(be,d-s))),e.charAt(d)!==n.charAt(c)&&(x*=Jt)),(x<xe&&r.charAt(d-1)===o.charAt(c+1)||o.charAt(c+1)===o.charAt(c)&&r.charAt(d-1)!==o.charAt(c))&&(j=je(e,n,r,o,d+1,c+2,i),j*xe>x&&(x=j*xe)),x>g&&(g=x),d=r.indexOf(h,d+1);return i[p]=g,g}function Ie(e){return e.toLowerCase().replace(Qe," ")}function nr(e,n,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,je(e,n,Ie(e),Ie(n),0,0,{})}var re='[cmdk-group=""]',ye='[cmdk-group-items=""]',lr='[cmdk-group-heading=""]',Xe='[cmdk-item=""]',Oe=`${Xe}:not([aria-disabled="true"])`,we="cmdk-item-select",H="data-value",ar=(e,n,r)=>nr(e,n,r),Ye=a.createContext(void 0),ae=()=>a.useContext(Ye),Ze=a.createContext(void 0),Ne=()=>a.useContext(Ze),Je=a.createContext(void 0),et=a.forwardRef((e,n)=>{let r=W(()=>{var l,f;return{search:"",value:(f=(l=e.value)!=null?l:e.defaultValue)!=null?f:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),o=W(()=>new Set),s=W(()=>new Map),c=W(()=>new Map),i=W(()=>new Set),p=tt(e),{label:h,children:d,value:g,onValueChange:x,filter:j,shouldFilter:k,loop:A,disablePointerSelection:B=!1,vimBindings:O=!0,...z}=e,X=L(),se=L(),Y=L(),E=a.useRef(null),w=vr();q(()=>{if(g!==void 0){let l=g.trim();r.current.value=l,N.emit()}},[g]),q(()=>{w(6,V)},[]);let N=a.useMemo(()=>({subscribe:l=>(i.current.add(l),()=>i.current.delete(l)),snapshot:()=>r.current,setState:(l,f,C)=>{var m,b,y,S;if(!Object.is(r.current[l],f)){if(r.current[l]=f,l==="search")K(),Z(),w(1,J);else if(l==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let D=document.getElementById(Y);D?D.focus():(m=document.getElementById(X))==null||m.focus()}if(w(7,()=>{var D;r.current.selectedItemId=(D=u())==null?void 0:D.id,N.emit()}),C||w(5,V),((b=p.current)==null?void 0:b.value)!==void 0){let D=f??"";(S=(y=p.current).onValueChange)==null||S.call(y,D);return}}N.emit()}},emit:()=>{i.current.forEach(l=>l())}}),[]),P=a.useMemo(()=>({value:(l,f,C)=>{var m;f!==((m=c.current.get(l))==null?void 0:m.value)&&(c.current.set(l,{value:f,keywords:C}),r.current.filtered.items.set(l,ce(f,C)),w(2,()=>{Z(),N.emit()}))},item:(l,f)=>(o.current.add(l),f&&(s.current.has(f)?s.current.get(f).add(l):s.current.set(f,new Set([l]))),w(3,()=>{K(),Z(),r.current.value||J(),N.emit()}),()=>{c.current.delete(l),o.current.delete(l),r.current.filtered.items.delete(l);let C=u();w(4,()=>{K(),(C==null?void 0:C.getAttribute("id"))===l&&J(),N.emit()})}),group:l=>(s.current.has(l)||s.current.set(l,new Set),()=>{c.current.delete(l),s.current.delete(l)}),filter:()=>p.current.shouldFilter,label:h||e["aria-label"],getDisablePointerSelection:()=>p.current.disablePointerSelection,listId:X,inputId:Y,labelId:se,listInnerRef:E}),[]);function ce(l,f){var C,m;let b=(m=(C=p.current)==null?void 0:C.filter)!=null?m:ar;return l?b(l,r.current.search,f):0}function Z(){if(!r.current.search||p.current.shouldFilter===!1)return;let l=r.current.filtered.items,f=[];r.current.filtered.groups.forEach(m=>{let b=s.current.get(m),y=0;b.forEach(S=>{let D=l.get(S);y=Math.max(D,y)}),f.push([m,y])});let C=E.current;v().sort((m,b)=>{var y,S;let D=m.getAttribute("id"),de=b.getAttribute("id");return((y=l.get(de))!=null?y:0)-((S=l.get(D))!=null?S:0)}).forEach(m=>{let b=m.closest(ye);b?b.appendChild(m.parentElement===b?m:m.closest(`${ye} > *`)):C.appendChild(m.parentElement===C?m:m.closest(`${ye} > *`))}),f.sort((m,b)=>b[1]-m[1]).forEach(m=>{var b;let y=(b=E.current)==null?void 0:b.querySelector(`${re}[${H}="${encodeURIComponent(m[0])}"]`);y==null||y.parentElement.appendChild(y)})}function J(){let l=v().find(C=>C.getAttribute("aria-disabled")!=="true"),f=l==null?void 0:l.getAttribute(H);N.setState("value",f||void 0)}function K(){var l,f,C,m;if(!r.current.search||p.current.shouldFilter===!1){r.current.filtered.count=o.current.size;return}r.current.filtered.groups=new Set;let b=0;for(let y of o.current){let S=(f=(l=c.current.get(y))==null?void 0:l.value)!=null?f:"",D=(m=(C=c.current.get(y))==null?void 0:C.keywords)!=null?m:[],de=ce(S,D);r.current.filtered.items.set(y,de),de>0&&b++}for(let[y,S]of s.current)for(let D of S)if(r.current.filtered.items.get(D)>0){r.current.filtered.groups.add(y);break}r.current.filtered.count=b}function V(){var l,f,C;let m=u();m&&(((l=m.parentElement)==null?void 0:l.firstChild)===m&&((C=(f=m.closest(re))==null?void 0:f.querySelector(lr))==null||C.scrollIntoView({block:"nearest"})),m.scrollIntoView({block:"nearest"}))}function u(){var l;return(l=E.current)==null?void 0:l.querySelector(`${Xe}[aria-selected="true"]`)}function v(){var l;return Array.from(((l=E.current)==null?void 0:l.querySelectorAll(Oe))||[])}function R(l){let f=v()[l];f&&N.setState("value",f.getAttribute(H))}function M(l){var f;let C=u(),m=v(),b=m.findIndex(S=>S===C),y=m[b+l];(f=p.current)!=null&&f.loop&&(y=b+l<0?m[m.length-1]:b+l===m.length?m[0]:m[b+l]),y&&N.setState("value",y.getAttribute(H))}function ee(l){let f=u(),C=f==null?void 0:f.closest(re),m;for(;C&&!m;)C=l>0?hr(C,re):gr(C,re),m=C==null?void 0:C.querySelector(Oe);m?N.setState("value",m.getAttribute(H)):M(l)}let ie=()=>R(v().length-1),G=l=>{l.preventDefault(),l.metaKey?ie():l.altKey?ee(1):M(1)},De=l=>{l.preventDefault(),l.metaKey?R(0):l.altKey?ee(-1):M(-1)};return a.createElement(I.div,{ref:n,tabIndex:-1,...z,"cmdk-root":"",onKeyDown:l=>{var f;(f=z.onKeyDown)==null||f.call(z,l);let C=l.nativeEvent.isComposing||l.keyCode===229;if(!(l.defaultPrevented||C))switch(l.key){case"n":case"j":{O&&l.ctrlKey&&G(l);break}case"ArrowDown":{G(l);break}case"p":case"k":{O&&l.ctrlKey&&De(l);break}case"ArrowUp":{De(l);break}case"Home":{l.preventDefault(),R(0);break}case"End":{l.preventDefault(),ie();break}case"Enter":{l.preventDefault();let m=u();if(m){let b=new Event(we);m.dispatchEvent(b)}}}}},a.createElement("label",{"cmdk-label":"",htmlFor:P.inputId,id:P.labelId,style:xr},h),me(e,l=>a.createElement(Ze.Provider,{value:N},a.createElement(Ye.Provider,{value:P},l))))}),sr=a.forwardRef((e,n)=>{var r,o;let s=L(),c=a.useRef(null),i=a.useContext(Je),p=ae(),h=tt(e),d=(o=(r=h.current)==null?void 0:r.forceMount)!=null?o:i==null?void 0:i.forceMount;q(()=>{if(!d)return p.item(s,i==null?void 0:i.id)},[d]);let g=rt(s,c,[e.value,e.children,c],e.keywords),x=Ne(),j=T(w=>w.value&&w.value===g.current),k=T(w=>d||p.filter()===!1?!0:w.search?w.filtered.items.get(s)>0:!0);a.useEffect(()=>{let w=c.current;if(!(!w||e.disabled))return w.addEventListener(we,A),()=>w.removeEventListener(we,A)},[k,e.onSelect,e.disabled]);function A(){var w,N;B(),(N=(w=h.current).onSelect)==null||N.call(w,g.current)}function B(){x.setState("value",g.current,!0)}if(!k)return null;let{disabled:O,value:z,onSelect:X,forceMount:se,keywords:Y,...E}=e;return a.createElement(I.div,{ref:ne(c,n),...E,id:s,"cmdk-item":"",role:"option","aria-disabled":!!O,"aria-selected":!!j,"data-disabled":!!O,"data-selected":!!j,onPointerMove:O||p.getDisablePointerSelection()?void 0:B,onClick:O?void 0:A},e.children)}),cr=a.forwardRef((e,n)=>{let{heading:r,children:o,forceMount:s,...c}=e,i=L(),p=a.useRef(null),h=a.useRef(null),d=L(),g=ae(),x=T(k=>s||g.filter()===!1?!0:k.search?k.filtered.groups.has(i):!0);q(()=>g.group(i),[]),rt(i,p,[e.value,e.heading,h]);let j=a.useMemo(()=>({id:i,forceMount:s}),[s]);return a.createElement(I.div,{ref:ne(p,n),...c,"cmdk-group":"",role:"presentation",hidden:x?void 0:!0},r&&a.createElement("div",{ref:h,"cmdk-group-heading":"","aria-hidden":!0,id:d},r),me(e,k=>a.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?d:void 0},a.createElement(Je.Provider,{value:j},k))))}),ir=a.forwardRef((e,n)=>{let{alwaysRender:r,...o}=e,s=a.useRef(null),c=T(i=>!i.search);return!r&&!c?null:a.createElement(I.div,{ref:ne(s,n),...o,"cmdk-separator":"",role:"separator"})}),dr=a.forwardRef((e,n)=>{let{onValueChange:r,...o}=e,s=e.value!=null,c=Ne(),i=T(d=>d.search),p=T(d=>d.selectedItemId),h=ae();return a.useEffect(()=>{e.value!=null&&c.setState("search",e.value)},[e.value]),a.createElement(I.input,{ref:n,...o,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":h.listId,"aria-labelledby":h.labelId,"aria-activedescendant":p,id:h.inputId,type:"text",value:s?e.value:i,onChange:d=>{s||c.setState("search",d.target.value),r==null||r(d.target.value)}})}),ur=a.forwardRef((e,n)=>{let{children:r,label:o="Suggestions",...s}=e,c=a.useRef(null),i=a.useRef(null),p=T(d=>d.selectedItemId),h=ae();return a.useEffect(()=>{if(i.current&&c.current){let d=i.current,g=c.current,x,j=new ResizeObserver(()=>{x=requestAnimationFrame(()=>{let k=d.offsetHeight;g.style.setProperty("--cmdk-list-height",k.toFixed(1)+"px")})});return j.observe(d),()=>{cancelAnimationFrame(x),j.unobserve(d)}}},[]),a.createElement(I.div,{ref:ne(c,n),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":p,"aria-label":o,id:h.listId},me(e,d=>a.createElement("div",{ref:ne(i,h.listInnerRef),"cmdk-list-sizer":""},d)))}),pr=a.forwardRef((e,n)=>{let{open:r,onOpenChange:o,overlayClassName:s,contentClassName:c,container:i,...p}=e;return a.createElement(gt,{open:r,onOpenChange:o},a.createElement(vt,{container:i},a.createElement(Ct,{"cmdk-overlay":"",className:s}),a.createElement(xt,{"aria-label":e.label,"cmdk-dialog":"",className:c},a.createElement(et,{ref:n,...p}))))}),mr=a.forwardRef((e,n)=>T(r=>r.filtered.count===0)?a.createElement(I.div,{ref:n,...e,"cmdk-empty":"",role:"presentation"}):null),fr=a.forwardRef((e,n)=>{let{progress:r,children:o,label:s="Loading...",...c}=e;return a.createElement(I.div,{ref:n,...c,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},me(e,i=>a.createElement("div",{"aria-hidden":!0},i)))}),Pe=Object.assign(et,{List:ur,Item:sr,Input:dr,Group:cr,Separator:ir,Dialog:pr,Empty:mr,Loading:fr});function hr(e,n){let r=e.nextElementSibling;for(;r;){if(r.matches(n))return r;r=r.nextElementSibling}}function gr(e,n){let r=e.previousElementSibling;for(;r;){if(r.matches(n))return r;r=r.previousElementSibling}}function tt(e){let n=a.useRef(e);return q(()=>{n.current=e}),n}var q=typeof window>"u"?a.useEffect:a.useLayoutEffect;function W(e){let n=a.useRef();return n.current===void 0&&(n.current=e()),n}function T(e){let n=Ne(),r=()=>e(n.snapshot());return a.useSyncExternalStore(n.subscribe,r,r)}function rt(e,n,r,o=[]){let s=a.useRef(),c=ae();return q(()=>{var i;let p=(()=>{var d;for(let g of r){if(typeof g=="string")return g.trim();if(typeof g=="object"&&"current"in g)return g.current?(d=g.current.textContent)==null?void 0:d.trim():s.current}})(),h=o.map(d=>d.trim());c.value(e,p,h),(i=n.current)==null||i.setAttribute(H,p),s.current=p}),s}var vr=()=>{let[e,n]=a.useState(),r=W(()=>new Map);return q(()=>{r.current.forEach(o=>o()),r.current=new Map},[e]),(o,s)=>{r.current.set(o,s),n({})}};function Cr(e){let n=e.type;return typeof n=="function"?n(e.props):"render"in n?n.render(e.props):e}function me({asChild:e,children:n},r){return e&&a.isValidElement(n)?a.cloneElement(Cr(n),{ref:n.ref},r(n.props.children)):r(n)}var xr={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function br({className:e,...n}){return t.jsx(Pe,{"data-slot":"command",className:ue("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...n})}function yr({className:e,...n}){return t.jsx(Pe.Group,{"data-slot":"command-group",className:ue("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...n})}function jr({className:e,...n}){return t.jsx(Pe.Item,{"data-slot":"command-item",className:ue("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...n})}function Rr({teamMember:e,onBack:n,onSave:r}){const[o,s]=a.useState({...e,email:e.email||"",dob:e.dob||""}),[c,i]=a.useState(!1),[p,h]=a.useState(!1),[d,g]=a.useState(!1),{data:x}=bt(),j=yt(),k=kt(),A=Nt(),B=Pt(),O=Dt(),z=Et(),X=x?x.map(u=>u.name):[],[se,Y]=a.useState(!1),[E,w]=a.useState(o.classes?o.classes.split(","):[]),N=u=>{let v;E.includes(u)?v=E.filter(R=>R!==u):v=[...E,u],w(v),P("classes",v.join(","))},P=(u,v)=>{s(R=>({...R,[u]:v}))},ce=u=>{u.preventDefault(),console.log(o),o.id&&o.id!=0?A.mutate({id:o.id,data:o},{onSuccess:()=>r(o)}):(console.log("creating"),k.mutate(o,{onSuccess:v=>{var R;console.log("✅ User created:",v),console.log("sending photo"),(R=v==null?void 0:v.user)!=null&&R.id&&K(v.id),r(v)},onError:v=>{console.error("❌ Error creating user:",v)},onSettled:()=>{console.log("ℹ️ createUser.mutate finished (success or error)")}})),r(o)},Z=()=>{o.id&&o.id!==0&&O.mutate(o.id,{onSuccess:()=>{console.log("Successfully password rest of team member:"),g(!0)},onError:u=>{console.error("Error deleting team member:",u)}}),console.log("Password reset requested for:",o.first_name)},J=()=>{o.id&&o.id!==0&&B.mutate(o.id,{onSuccess:u=>{console.log("Successfully deleted team member:",u),h(!1),n()},onError:u=>{console.error("Error deleting team member:",u)}})},K=u=>{const v=document.createElement("input");v.type="file",v.accept="image/*",v.style.display="none",v.onchange=R=>{var ee;const M=(ee=R.target.files)==null?void 0:ee[0];if(M){u!=0&&z.mutate({userId:u,file:M},{onSuccess:G=>{console.log("Uploaded:",G),i(!0),j.invalidateQueries({queryKey:["users"]})},onError:G=>{console.error("Upload failed",G)}});const ie=URL.createObjectURL(M);P("photo",ie),console.log("Photo uploaded:",M.name)}},document.body.appendChild(v),v.click(),document.body.removeChild(v)},V=!e.first_name||e.id===Date.now()||e.first_name==="";return t.jsx("div",{className:"flex-1 px-6 py-8",style:{backgroundColor:"#F8F9FA"},children:t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("div",{className:"bg-white px-4 py-2 border",style:{borderColor:"#e65039"},children:t.jsx("h2",{className:"text-lg font-bold",style:{color:"#3C3C3C"},children:V?"Add New Team member / CT":"Edit Team member / CT"})}),t.jsx(F,{onClick:n,className:"px-6 py-2 rounded-lg transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:"Back"})]}),t.jsx("div",{className:"bg-white p-8 rounded-lg shadow-sm",children:t.jsxs("form",{onSubmit:ce,className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx(_,{htmlFor:"first_name",className:"block mb-2",style:{color:"#3C3C3C"},children:"First Name"}),t.jsx($,{id:"first_name",type:"text",value:o.first_name,onChange:u=>P("first_name",u.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"},required:!0})]}),t.jsxs("div",{children:[t.jsx(_,{htmlFor:"last_name",className:"block mb-2",style:{color:"#3C3C3C"},children:"Last Name"}),t.jsx($,{id:"last_name",type:"text",value:o.last_name,onChange:u=>P("last_name",u.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"},required:!0})]}),t.jsxs("div",{children:[t.jsx(_,{htmlFor:"id_number",className:"block mb-2",style:{color:"#3C3C3C"},children:"ID Number"}),t.jsx($,{id:"id_number",type:"text",value:o.id_number,onChange:u=>P("id_number",u.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"},required:!0})]}),t.jsxs("div",{children:[t.jsx(_,{htmlFor:"dob",className:"block mb-2",style:{color:"#3C3C3C"},children:"DOB"}),t.jsx($,{id:"dob",type:"date",value:o.dob,onChange:u=>P("dob",u.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"},placeholder:"dd/mm/yyyy"})]}),t.jsxs("div",{children:[t.jsx(_,{htmlFor:"specialization",className:"block mb-2",style:{color:"#3C3C3C"},children:"Specialisation"}),t.jsx($,{id:"specialization",type:"text",value:o.specialization,onChange:u=>P("specialization",u.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"}})]}),t.jsxs("div",{children:[t.jsx(_,{htmlFor:"email",className:"block mb-2",style:{color:"#3C3C3C"},children:"Email"}),t.jsx($,{id:"email",type:"email",value:o.email,onChange:u=>P("email",u.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"}})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx(_,{htmlFor:"role",className:"block mb-2",style:{color:"#3C3C3C"},children:"Role"}),t.jsxs(Ee,{value:o.role,onValueChange:u=>P("role",u),children:[t.jsx(Se,{className:"w-full border-2 rounded-none",style:{borderColor:"#BDC3C7"},children:t.jsx(Re,{placeholder:"Team member"})}),t.jsxs(_e,{className:"bg-white border border-gray-200 shadow-lg rounded-md",style:{backgroundColor:"white",borderColor:"#BDC3C7",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},children:[t.jsx(te,{value:"teacher",className:"hover:bg-gray-100 focus:bg-gray-100",style:{color:"#3C3C3C"},children:"Team member"}),t.jsx(te,{value:"ct",className:"hover:bg-gray-100 focus:bg-gray-100",style:{color:"#3C3C3C"},children:"CT"})]})]})]}),(o.role==="teacher"||o.role==="ct")&&t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(wt,{id:"is_ct",checked:o.is_ct?o.is_ct:!1,onCheckedChange:u=>P("is_ct",u),disabled:o.role==="ct"}),t.jsx(_,{htmlFor:"is_ct",className:"text-sm text-gray-700",children:"Also CT"})]}),t.jsxs("div",{children:[t.jsx(_,{htmlFor:"gender",className:"block mb-2",style:{color:"#3C3C3C"},children:"Gender"}),t.jsxs(Ee,{value:o.gender,onValueChange:u=>P("gender",u),children:[t.jsx(Se,{className:"w-full border-2 rounded-none",style:{borderColor:"#BDC3C7"},children:t.jsx(Re,{placeholder:"Select gender"})}),t.jsxs(_e,{className:"bg-white border border-gray-200 shadow-lg rounded-md",style:{backgroundColor:"white",borderColor:"#BDC3C7",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},children:[t.jsx(te,{value:"Male",className:"hover:bg-gray-100 focus:bg-gray-100",style:{color:"#3C3C3C"},children:"Male"}),t.jsx(te,{value:"Female",className:"hover:bg-gray-100 focus:bg-gray-100",style:{color:"#3C3C3C"},children:"Female"}),t.jsx(te,{value:"Other",className:"hover:bg-gray-100 focus:bg-gray-100",style:{color:"#3C3C3C"},children:"Other"})]})]})]}),t.jsxs("div",{children:[t.jsx(_,{htmlFor:"class",className:"block mb-2",style:{color:"#3C3C3C"},children:"Classes"}),t.jsxs(Ht,{open:se,onOpenChange:Y,children:[t.jsx(Wt,{asChild:!0,children:t.jsxs(F,{variant:"outline",role:"combobox",className:"w-full justify-between border-2 rounded-none",style:{borderColor:"#BDC3C7"},children:[E.length>0?E.join(", "):"Select class",t.jsx(At,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),t.jsx(Qt,{className:"w-full p-0 bg-white",children:t.jsx(br,{children:t.jsx(yr,{children:X.map(u=>t.jsxs(jr,{onSelect:()=>N(u),className:"cursor-pointer",children:[t.jsx(jt,{className:`mr-2 h-4 w-4 ${E.join(",").includes(u)?"opacity-100":"opacity-0"}`}),u]},u))})})})]})]}),t.jsxs("div",{children:[t.jsx(_,{htmlFor:"date_of_joining",className:"block mb-2",style:{color:"#3C3C3C"},children:"Date of joining"}),t.jsx($,{id:"date_of_joining",type:"date",value:o.date_of_joining,onChange:u=>P("date_of_joining",u.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"}})]}),!V&&t.jsx("div",{className:"flex justify-end",children:t.jsxs(F,{type:"button",onClick:()=>h(!0),className:"px-6 py-2 font-medium transition-all duration-200 hover:opacity-90 flex items-center space-x-2",style:{backgroundColor:"#DC3545",color:"white",borderColor:"#DC3545"},children:[t.jsx(Rt,{className:"w-4 h-4"}),t.jsx("span",{children:"Delete Team Member"})]})})]})]}),t.jsxs("div",{className:"flex flex-col items-center space-y-4 py-6",children:[t.jsxs("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden border-2",style:{borderColor:"#BDC3C7"},children:[o.photo?t.jsx("img",{src:o.photo,alt:`${o.first_name}'s photo`,className:"w-full h-full object-cover",onError:u=>{var v;u.target.style.display="none",(v=u.target.nextElementSibling)==null||v.classList.remove("hidden")}}):null,t.jsx(_t,{className:`w-8 h-8 ${o.photo?"hidden":""}`,style:{color:"#BDC3C7"}})]}),t.jsxs("button",{type:"button",onClick:()=>K(o.id),className:"flex items-center space-x-2 px-4 py-2 border-2 rounded-lg transition-all duration-200 hover:bg-blue-50",style:{borderColor:"#e65039",color:"#e65039",backgroundColor:"white"},children:[t.jsx(St,{className:"w-4 h-4"}),t.jsx("span",{children:"Change photo"})]})]}),t.jsxs("div",{className:"space-y-3 pt-4",children:[t.jsx(F,{type:"button",onClick:Z,className:"w-full border-2 px-4 py-3 rounded-none transition-all duration-200 hover:opacity-90",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Reset Password"}),t.jsx(F,{type:"submit",className:"w-full px-4 py-3 rounded-none transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:V?"Create":"Update"})]}),t.jsx(fe,{open:c,onOpenChange:i,children:t.jsxs(he,{className:"max-w-md bg-white rounded-lg border-2",style:{backgroundColor:"white",borderColor:"#BDC3C7"},children:[t.jsxs(ge,{children:[t.jsx(ve,{style:{color:"#3C3C3C"},children:"Photo Update"}),t.jsx(Ce,{style:{color:"#6C757D"},children:"Photo has been successfully updated."})]}),t.jsx("div",{className:"flex justify-end space-x-3 pt-2",children:t.jsx(F,{onClick:()=>i(!1),className:"px-4 py-2 border-2 transition-all duration-200",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Ok"})})]})}),t.jsx(fe,{open:d,onOpenChange:g,children:t.jsxs(he,{className:"max-w-md bg-white rounded-lg border-2",style:{backgroundColor:"white",borderColor:"#BDC3C7"},children:[t.jsxs(ge,{children:[t.jsx(ve,{style:{color:"#3C3C3C"},children:"Password Update"}),t.jsx(Ce,{style:{color:"#6C757D"},children:"Password has been reset succesfully."})]}),t.jsx("div",{className:"flex justify-end space-x-3 pt-2",children:t.jsx(F,{onClick:()=>g(!1),className:"px-4 py-2 border-2 transition-all duration-200",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Ok"})})]})}),t.jsx(fe,{open:p,onOpenChange:h,children:t.jsxs(he,{className:"max-w-md bg-white rounded-lg border-2",style:{backgroundColor:"white",borderColor:"#DC3545"},children:[t.jsxs(ge,{children:[t.jsx(ve,{style:{color:"#DC3545"},children:"Delete Team Member"}),t.jsxs(Ce,{style:{color:"#6C757D"},children:["Are you sure you want to delete ",o.first_name," ",o.last_name,"? This action cannot be undone."]})]}),t.jsxs("div",{className:"flex justify-end space-x-3 pt-2",children:[t.jsx(F,{onClick:()=>h(!1),className:"px-4 py-2 border-2 transition-all duration-200",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Cancel"}),t.jsx(F,{onClick:J,disabled:B.isPending,className:"px-4 py-2 transition-all duration-200",style:{backgroundColor:"#DC3545",color:"white",borderColor:"#DC3545"},children:B.isPending?"Deleting...":"Delete"})]})]})}),t.jsx("div",{className:"mt-6 pt-4",children:t.jsx("div",{className:"bg-yellow-100 px-4 py-3 border-l-4 rounded-r",style:{borderColor:"#FF8C42"},children:t.jsx("p",{className:"text-sm",style:{color:"#3C3C3C"},children:"⚠️ Admin can reset the password of team members"})})})]})})]})})}export{Rr as EditTeamMemberPage};
