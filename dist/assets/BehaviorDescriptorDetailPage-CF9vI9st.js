import{u as h,t as u,v as p,k as x,r as i,j as e,B as C}from"./index-Bnf_FfGu.js";import{C as j}from"./chevron-left-v2SQpheK.js";function y(t){return h({queryKey:["comments",t],queryFn:async()=>{const{data:s}=await x.get(`/api/comments/${t}/`);return s}})}function v(t){const s=u();return p({mutationFn:async o=>{const{data:r}=await x.post(`/api/comments/${t}/`,o);return r},onSuccess:()=>{s.invalidateQueries({queryKey:["comments",t]})}})}function g({descriptorId:t}){const{data:s,isLoading:o}=y(t),r=v(t),[n,d]=i.useState("");if(o)return e.jsx("p",{children:"Loading comments..."});const l=()=>{n.trim()&&(r.mutate({content:n}),d(""))},a=(c,m)=>{m.trim()&&r.mutate({content:m,parent_id:c})};return e.jsxs("div",{className:"p-4 border rounded-lg bg-white shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Comments"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:n,onChange:c=>d(c.target.value),placeholder:"Add a comment...",className:"flex-1 p-2 border rounded"}),e.jsx("button",{onClick:l,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",disabled:!n.trim(),style:{backgroundColor:n.trim()?"#e65039":"#BDC3C7",color:"white",borderColor:n.trim()?"#e65039":"#BDC3C7"},children:"Post"})]}),e.jsx("div",{className:"space-y-4",children:s==null?void 0:s.map(c=>e.jsx(N,{comment:c,onReply:a},c.id))})]})}function N({comment:t,onReply:s}){const[o,r]=i.useState(""),[n,d]=i.useState(!1),l=a=>new Date(a).toLocaleString();return e.jsxs("div",{className:"border-b pb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:t.user.username}),e.jsxs("span",{className:"text-gray-400",children:["• ",l(t.created_at)]})]}),e.jsx("p",{className:"mt-1",children:t.content}),e.jsx("button",{onClick:()=>d(!n),className:"text-sm text-blue-500 hover:underline mt-1",children:"Reply"}),n&&e.jsxs("div",{className:"ml-4 mt-2 flex gap-2",children:[e.jsx("input",{type:"text",value:o,onChange:a=>r(a.target.value),placeholder:"Write a reply...",className:"flex-1 p-2 border rounded"}),e.jsx("button",{onClick:()=>{s(t.id,o),r(""),d(!1)},className:"px-3 py-1 bg-green-500 text-white rounded hover:bg-green-600",children:"Reply"})]}),t.replies.length>0&&e.jsx("div",{className:"ml-6 mt-2 space-y-2",children:t.replies.map(a=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold",children:a.user.username}),e.jsxs("span",{className:"text-gray-400",children:["• ",l(a.created_at)]})]}),e.jsx("p",{className:"text-sm text-gray-700",children:a.content})]},a.id))})]})}function w({student:t,behaviorDescriptor:s,onBack:o}){const r=i.useRef(null),n=80,d=100;return i.useEffect(()=>{const l=r.current;if(!l)return;const a=()=>{l.currentTime>=d&&l.pause()};l.addEventListener("timeupdate",a);const c=()=>{l.currentTime=n,l.play()};return l.addEventListener("loadedmetadata",c),()=>{l.removeEventListener("timeupdate",a),l.removeEventListener("loadedmetadata",c)}},[n,d]),e.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"#F8F9FA"},children:[e.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6 lg:py-8",style:{backgroundColor:"#fff5f3"},children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex space-x-2 sm:space-x-4",children:[e.jsx("div",{className:"px-3 sm:px-6 py-2 sm:py-3 text-sm sm:text-base border-2 transition-all duration-200",style:{borderColor:"#e65039",color:"white",backgroundColor:"#e65039"},children:"Team member"}),e.jsx("div",{className:"px-3 sm:px-6 py-2 sm:py-3 text-sm sm:text-base border-2 opacity-50 cursor-not-allowed",style:{borderColor:"#BDC3C7",color:"#6C757D",backgroundColor:"white"},children:"Core Team (CT)"})]})})}),e.jsx("div",{className:"px-4 sm:px-6 py-2",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:o,style:{color:"#e65039"},className:"hover:underline",children:"Home"}),e.jsx("span",{style:{color:"#e65039"},children:" > "}),e.jsx("span",{style:{color:"#e65039"},children:t.name}),e.jsx("span",{style:{color:"#e65039"},children:" > "}),e.jsx("span",{style:{color:"#e65039"},children:"BD"})]}),e.jsxs(C,{onClick:o,className:"flex items-center space-x-2 px-6 py-2 font-medium transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",borderColor:"#e65039"},children:[e.jsx(j,{className:"w-5 h-5"}),e.jsx("span",{children:"Back"})]})]})})}),e.jsx("div",{className:"px-4 sm:px-6 pb-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-6",children:e.jsx("div",{className:"aspect-video bg-black flex items-center justify-center",children:e.jsxs("video",{ref:r,controls:!0,className:"w-full h-full",children:[e.jsx("source",{src:s.video_url,type:"video/mp4"}),"Your browser does not support the video tag."]})})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-6 p-6",children:[e.jsx("h3",{className:"font-bold mb-4",style:{color:"#3C3C3C"},children:"Behavior Descriptor Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{style:{color:"#3C3C3C"},children:"Date:"}),e.jsx("span",{className:"ml-2",style:{color:"#3C3C3C"},children:s.date})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{style:{color:"#3C3C3C"},children:"Time:"}),e.jsx("span",{className:"ml-2",style:{color:"#3C3C3C"},children:s.time})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{style:{color:"#3C3C3C"},children:"Source:"}),e.jsx("span",{className:"ml-2",style:{color:"#3C3C3C"},children:s.source})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{style:{color:"#3C3C3C"},children:"GCO:"}),e.jsx("span",{className:"ml-2",style:{color:"#3C3C3C"},children:s.gco_classification})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{style:{color:"#3C3C3C"},children:"Action:"}),e.jsx("div",{className:"mt-1",style:{color:"#3C3C3C"},children:s.action})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{style:{color:"#3C3C3C"},children:"Trigger:"}),e.jsx("div",{className:"mt-1",style:{color:"#3C3C3C"},children:s.trigger})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{style:{color:"#3C3C3C"},children:"Context:"}),e.jsx("div",{className:"mt-1",style:{color:"#3C3C3C"},children:s.context})]})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden p-6",children:e.jsx(g,{descriptorId:s.id})})]})})]})}export{w as BehaviorDescriptorDetailPage};
