import{r as g,t as V,aj as Q,ak as $,al as z,M as H,j as e,B as d,L as r,I as t,S as f,f as N,g as v,h as D,i as m,D as w,a as _,b as k,d as S,e as B}from"./index-C_w9ghux.js";import{c as K,U as J}from"./useUploadFile-C_PytDtH.js";import{T as W}from"./trash-2-D2UojCYO.js";import{U as X}from"./user-C1rgOXji.js";function oe({client:n,onBack:b,onSave:u}){const[o,F]=g.useState({...n,email:n.email||"",dob:n.dob||"",guardian_name:n.guardian_name||"",guardian_contact:n.guardian_contact||"",date_of_enrollment:n.date_of_enrollment||new Date().toISOString().split("T")[0]}),[U,C]=g.useState(!1),[O,c]=g.useState(!1),E=V(),I=Q(),P=$(),T=z(),{data:y}=H(),A=y?y.map(l=>l.name):[],L=K(),s=(l,a)=>{F(x=>({...x,[l]:a}))},M=l=>{l.preventDefault(),console.log(o),o.id&&o.id!=0?P.mutate({id:o.id,data:o},{onSuccess:()=>u(o)}):I.mutate(o,{onSuccess:()=>u(o)}),u(o)},q=()=>{console.log(o),o.id&&o.id!==0&&(T.mutate(o.id,{onSuccess:()=>{b()},onError:l=>{console.error("Error deleting client:",l)}}),c(!1))},G=l=>{const a=document.createElement("input");a.type="file",a.accept="image/*",a.style.display="none",a.onchange=x=>{var j;const i=(j=x.target.files)==null?void 0:j[0];if(i){L.mutate({studentId:l,file:i},{onSuccess:p=>{console.log("Uploaded:",p),C(!0),E.invalidateQueries({queryKey:["allstudents"]})},onError:p=>{console.error("Upload failed",p)}});const R=URL.createObjectURL(i);s("photo",R),console.log("Photo uploaded:",i.name)}},document.body.appendChild(a),a.click(),document.body.removeChild(a)},h=!n.name||n.id===Date.now()||n.name==="";return e.jsx("div",{className:"flex-1 px-6 py-8",style:{backgroundColor:"#F8F9FA"},children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"bg-white px-4 py-2 border",style:{borderColor:"#e65039"},children:e.jsx("h2",{className:"text-lg font-bold",style:{color:"#3C3C3C"},children:h?"Add New Client":"Edit Client"})}),e.jsx(d,{onClick:b,className:"px-6 py-2 rounded-lg transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:"Back"})]}),e.jsx("div",{className:"bg-white p-8 rounded-lg shadow-sm",children:e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"name",className:"block mb-2",style:{color:"#3C3C3C"},children:"Name"}),e.jsx(t,{id:"name",type:"text",value:o.name,onChange:l=>s("name",l.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"},required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"dob",className:"block mb-2",style:{color:"#3C3C3C"},children:"DOB"}),e.jsx(t,{id:"dob",type:"date",value:o.dob,onChange:l=>s("dob",l.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"},placeholder:"dd/mm/yyyy"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"primary_diagnosis",className:"block mb-2",style:{color:"#3C3C3C"},children:"Primary Diagnosis"}),e.jsx(t,{id:"primary_diagnosis",type:"text",value:o.primary_diagnosis,onChange:l=>s("primary_diagnosis",l.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"}})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"guardian_name",className:"block mb-2",style:{color:"#3C3C3C"},children:"Guardian Name"}),e.jsx(t,{id:"guardian_name",type:"text",value:o.guardian_name,onChange:l=>s("guardian_name",l.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"}})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"date_of_enrollment",className:"block mb-2",style:{color:"#3C3C3C"},children:"Date of Enrollment"}),e.jsx(t,{id:"date_of_enrollment",type:"date",value:o.date_of_enrollment,onChange:l=>s("date_of_enrollment",l.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"}})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"chronological_age",className:"block mb-2",style:{color:"#3C3C3C"},children:"Age"}),e.jsx(t,{id:"chronological_age",type:"number",value:o.chronological_age,onChange:l=>s("chronological_age",parseInt(l.target.value)||0),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"},min:"0"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"gender",className:"block mb-2",style:{color:"#3C3C3C"},children:"Gender"}),e.jsxs(f,{value:o.gender,onValueChange:l=>s("gender",l),children:[e.jsx(N,{className:"w-full border-2 rounded-none",style:{borderColor:"#BDC3C7"},children:e.jsx(v,{placeholder:"Select gender"})}),e.jsxs(D,{className:"bg-white border border-gray-200 shadow-lg rounded-md",style:{backgroundColor:"white",borderColor:"#BDC3C7",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},children:[e.jsx(m,{value:"M",className:"hover:bg-gray-100 focus:bg-gray-100",style:{color:"#3C3C3C"},children:"Male"}),e.jsx(m,{value:"F",className:"hover:bg-gray-100 focus:bg-gray-100",style:{color:"#3C3C3C"},children:"Female"}),e.jsx(m,{value:"O",className:"hover:bg-gray-100 focus:bg-gray-100",style:{color:"#3C3C3C"},children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"secondary_diagnosis",className:"block mb-2",style:{color:"#3C3C3C"},children:"Secondary Diagnosis"}),e.jsx(t,{id:"secondary_diagnosis",type:"text",value:o.secondary_diagnosis,onChange:l=>s("secondary_diagnosis",l.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"}})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"guardian_contact",className:"block mb-2",style:{color:"#3C3C3C"},children:"Guardian Contact"}),e.jsx(t,{id:"guardian_contact",type:"tel",value:o.guardian_contact,onChange:l=>s("guardian_contact",l.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"}})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"class_name",className:"block mb-2",style:{color:"#3C3C3C"},children:"Class"}),e.jsxs(f,{value:o.class_name,onValueChange:l=>s("class_name",l),children:[e.jsx(N,{className:"w-full border-2 rounded-none",style:{borderColor:"#BDC3C7"},children:e.jsx(v,{placeholder:"Select class"})}),e.jsx(D,{className:"bg-white border border-gray-200 shadow-lg rounded-md",style:{backgroundColor:"white",borderColor:"#BDC3C7",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},children:A.map(l=>e.jsx(m,{value:l,className:"hover:bg-gray-100 focus:bg-gray-100",style:{color:"#3C3C3C"},children:l},l))})]})]}),!h&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(d,{type:"button",onClick:()=>c(!0),className:"px-6 py-2 font-medium transition-all duration-200 hover:opacity-90 flex items-center space-x-2",style:{backgroundColor:"#DC3545",color:"white",borderColor:"#DC3545"},children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"Delete Client"})]})})]})]}),e.jsxs("div",{className:"flex flex-col items-center space-y-4 py-6",children:[e.jsxs("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden border-2",style:{borderColor:"#BDC3C7"},children:[o.photo?e.jsx("img",{src:o.photo,alt:`${o.name}'s photo`,className:"w-full h-full object-cover",onError:l=>{var a;l.target.style.display="none",(a=l.target.nextElementSibling)==null||a.classList.remove("hidden")}}):null,e.jsx(X,{className:`w-8 h-8 ${o.photo?"hidden":""}`,style:{color:"#BDC3C7"}})]}),e.jsxs("button",{type:"button",onClick:()=>G(o.id),className:"flex items-center space-x-2 px-4 py-2 border-2 rounded-lg transition-all duration-200 hover:bg-blue-50",style:{borderColor:"#e65039",color:"#e65039",backgroundColor:"white"},children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"Change photo"})]})]}),e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx(r,{htmlFor:"id_number",className:"block mb-2",style:{color:"#3C3C3C"},children:"ID Number"}),e.jsx(t,{id:"id_number",type:"text",value:o.id_number,onChange:l=>s("id_number",l.target.value),className:"w-full border-2 px-3 py-2 rounded-none",style:{borderColor:"#BDC3C7"},placeholder:"Auto-generated or manual entry"})]}),e.jsx("div",{className:"space-y-3 pt-4",children:e.jsx(d,{type:"submit",className:"w-full px-4 py-3 rounded-none transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:h?"Create Client":"Update Client"})}),e.jsx(w,{open:U,onOpenChange:C,children:e.jsxs(_,{className:"max-w-md bg-white rounded-lg border-2",style:{backgroundColor:"white",borderColor:"#BDC3C7"},children:[e.jsxs(k,{children:[e.jsx(S,{style:{color:"#3C3C3C"},children:"Photo Update"}),e.jsx(B,{style:{color:"#6C757D"},children:"Photo has been successfully updated."})]}),e.jsx("div",{className:"flex justify-end space-x-3 pt-2",children:e.jsx(d,{onClick:()=>C(!1),className:"px-4 py-2 border-2 transition-all duration-200",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Ok"})})]})}),e.jsx(w,{open:O,onOpenChange:c,children:e.jsxs(_,{className:"max-w-md bg-white rounded-lg border-2",style:{backgroundColor:"white",borderColor:"#DC3545"},children:[e.jsxs(k,{children:[e.jsx(S,{style:{color:"#DC3545"},children:"Delete Client"}),e.jsxs(B,{style:{color:"#6C757D"},children:["Are you sure you want to delete ",o.name,"? This action cannot be undone."]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-2",children:[e.jsx(d,{onClick:()=>c(!1),className:"px-4 py-2 border-2 transition-all duration-200",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Cancel"}),e.jsx(d,{onClick:q,className:"px-4 py-2 transition-all duration-200",style:{backgroundColor:"#DC3545",color:"white",borderColor:"#DC3545"},children:"Delete"})]})]})}),e.jsx("div",{className:"mt-6 pt-4",children:e.jsx("div",{className:"bg-blue-50 px-4 py-3 border-l-4 rounded-r",style:{borderColor:"#e65039"},children:e.jsx("p",{className:"text-sm",style:{color:"#3C3C3C"},children:"ℹ️ Client information will be used for personalized care plans and progress tracking"})})})]})})]})})}export{oe as EditClientPage};
