import{r as h,t as H,al as q,j as e,l as M,m as $,n as k,o as r,p as J,q as t,D as u,_ as U,a as y,b as j,d as b,e as g,B as n,$ as V,am as K,X as Q}from"./index-DBWuzrFm.js";import{b as z,c as W,U as f}from"./useUploadFile-DSiQ269z.js";import{C as X}from"./camera-CMdEI_NG.js";import{D as Y,F as Z}from"./file-spreadsheet-BQa_kX7P.js";function ae({onEditClient:N,onAddClient:w}){const[d,F]=h.useState(null),P=H(),[S,C]=h.useState(!1),[c,x]=h.useState(null),[B,m]=h.useState(!1),{data:i}=q(),E=z(),T=l=>{F({name:l,hasPhoto:!1,photoUrl:void 0})},A=()=>{const l=`Name,Age,Gender,ID Number,Primary Diagnosis,Secondary Diagnosis,Date of Enrollment,Email,DOB,Guardian Name,Guardian Contact,Class,CT
John Doe,25,M,CL001,Speech and Language,,2024-01-15,john@example.com,1999-03-15,Jane Doe,+65 9123 4567,Class A,
Mary Smith,30,F,CL002,Autism,,2024-02-10,mary@example.com,1994-07-22,John Smith,+65 9876 5432,Class A,Sarah`,s=new Blob([l],{type:"text/csv"}),o=window.URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download="clients_template.csv",a.click(),window.URL.revokeObjectURL(o)},D=()=>{const l=document.createElement("input");l.type="file",l.accept=".xlsx,.xls,.csv",l.style.display="none",l.onchange=s=>{var a;const o=(a=s.target.files)==null?void 0:a[0];o&&(console.log("Excel file selected:",o.name),x(o))},document.body.appendChild(l),l.click(),document.body.removeChild(l)},O=()=>{c&&(console.log("Processing client bulk upload for file:",c.name),c&&E.mutate(c),x(null),C(!1))},_=(l,s)=>{s.stopPropagation(),N&&N(l)},G=()=>{w&&w()},I=()=>{x(null),C(!1)},L=W(),R=l=>{const s=document.createElement("input");s.type="file",s.accept="image/*",s.style.display="none",s.onchange=o=>{var v;const a=(v=o.target.files)==null?void 0:v[0];a&&L.mutate({studentId:l,file:a},{onSuccess:p=>{console.log("Uploaded:",p),m(!0),P.invalidateQueries({queryKey:["allstudents"]})},onError:p=>{console.error("Upload failed",p)}})},document.body.appendChild(s),s.click(),document.body.removeChild(s)};return e.jsx("div",{className:"flex-1 px-6 py-8",style:{backgroundColor:"#F8F9FA"},children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsx("h2",{className:"text-2xl font-bold",style:{color:"#3C3C3C"},children:"Clients"})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(M,{children:[e.jsx($,{children:e.jsxs(k,{className:"border-b-2",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:[e.jsx(r,{style:{color:"#3C3C3C"},children:"No."}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Name"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Age"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Gender"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"ID"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Primary Diagnosis"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Secondary Diagnosis"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"CT Assigned"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Date of Enrollment"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Photo"}),e.jsx(r,{style:{color:"#3C3C3C"},children:"Edit"})]})}),e.jsx(J,{children:i==null?void 0:i.map((l,s)=>{var o;return e.jsxs(k,{className:`${s<i.length-1?"border-b":""} hover:bg-gray-50 transition-colors`,style:{borderColor:"#BDC3C7"},children:[e.jsx(t,{style:{color:"#3C3C3C"},children:s+1}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.name}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.chronological_age}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.gender}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.id_number}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.primary_diagnosis}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.secondary_diagnosis}),e.jsx(t,{style:{color:"#3C3C3C"},children:(o=l.ct)==null?void 0:o.first_name}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.date_of_enrollment}),e.jsx(t,{className:"text-center",children:e.jsxs(u,{children:[e.jsx(U,{asChild:!0,children:e.jsx("button",{className:"w-10 h-8 border border-red-500 bg-red-50 flex items-center justify-center hover:bg-red-100 transition-colors rounded",onClick:()=>T(l.name),title:`View/Upload photo for ${l.name}`,children:e.jsx(X,{className:"w-4 h-4",style:{color:"#DC3545"}})})}),e.jsx(y,{className:"max-w-md mx-auto bg-white rounded-lg shadow-xl border-2 p-6",style:{borderColor:"#BDC3C7",backgroundColor:"white"},children:d&&e.jsxs(e.Fragment,{children:[e.jsxs(j,{className:"pb-4 text-left",children:[e.jsxs(b,{className:"text-lg font-bold",style:{color:"#3C3C3C"},children:[d.name," - Photo"]}),e.jsxs(g,{className:"text-sm mt-2",style:{color:"#6C757D"},children:["View the photo for ",d.name,". Click outside to close this dialog."]})]}),e.jsx("div",{className:"flex justify-center py-6",children:e.jsx("div",{className:"rounded-lg flex items-center justify-center overflow-hidden",style:{backgroundColor:"#E8F4F8"},children:l.photo?e.jsx("img",{src:l.photo,alt:`Photo of ${l.name}`,className:"max-w-full h-auto rounded-lg",style:{maxHeight:"300px",maxWidth:"300px"}},l.photo):e.jsx("img",{src:"/placeholder-user.png",alt:"No photo available",className:"max-w-full h-auto",style:{maxHeight:"300px"}})})}),e.jsxs("div",{className:"flex justify-center space-x-3 pt-4",children:[e.jsxs(n,{className:"px-4 py-2 rounded-lg transition-all duration-200 hover:opacity-90",onClick:()=>R(l.id),style:{backgroundColor:"#e65039",color:"white",border:"none"},children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Upload New Photo"]}),d.hasPhoto&&e.jsx(n,{variant:"outline",className:"px-4 py-2 rounded-lg border-2 transition-all duration-200 hover:opacity-90",style:{borderColor:"#DC3545",color:"#DC3545",backgroundColor:"white"},children:"Remove Photo"})]})]})})]})}),e.jsx(t,{children:e.jsx(n,{onClick:a=>_(l,a),className:"p-1 border rounded transition-all duration-200 hover:opacity-90",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:e.jsx(V,{className:"w-4 h-4"})})})]},l.id)})})]})})}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsxs(u,{open:S,onOpenChange:C,children:[e.jsx(U,{asChild:!0,children:e.jsxs(n,{className:"flex items-center space-x-2 px-6 py-2 transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:"Upload"})]})}),e.jsxs(y,{className:"max-w-md",style:{backgroundColor:"white"},children:[e.jsxs(j,{children:[e.jsx(b,{className:"text-lg font-bold",style:{color:"#3C3C3C"},children:"Bulk Upload Clients"}),e.jsx(g,{className:"text-sm",style:{color:"#6C757D"},children:"Upload multiple clients at once using an Excel file. Follow the two-step process below."})]}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",style:{color:"#3C3C3C"},children:"Step 1: Download Template"}),e.jsxs(n,{onClick:A,className:"w-full flex items-center space-x-2 border-2 px-4 py-2 transition-all duration-200 hover:bg-blue-50",style:{backgroundColor:"white",borderColor:"#e65039",color:"#e65039"},children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{children:"Download Excel Template"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",style:{color:"#3C3C3C"},children:"Step 2: Upload Completed File"}),c?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 border rounded-lg",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"w-5 h-5",style:{color:"#e65039"}}),e.jsx("span",{className:"text-sm font-medium",style:{color:"#3C3C3C"},children:c.name})]}),e.jsxs("p",{className:"text-xs mt-1",style:{color:"#6C757D"},children:[(c.size/1024).toFixed(1)," KB"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(n,{onClick:D,className:"flex-1 border-2 px-4 py-2 transition-all duration-200 hover:bg-blue-50",style:{backgroundColor:"white",borderColor:"#e65039",color:"#e65039"},children:"Change File"}),e.jsx(n,{onClick:O,className:"flex-1 px-4 py-2 transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:"Upload"})]})]}):e.jsxs(n,{onClick:D,className:"w-full border-2 border-dashed px-6 py-6 transition-all duration-200 hover:bg-blue-50 flex flex-col items-center justify-center space-y-3 min-h-[120px]",style:{backgroundColor:"white",borderColor:"#e65039",color:"#e65039"},children:[e.jsx(f,{className:"w-6 h-6 flex-shrink-0"}),e.jsxs("div",{className:"text-center space-y-1 max-w-full",children:[e.jsx("p",{className:"font-medium text-sm leading-tight",children:"Choose Excel File"}),e.jsx("p",{className:"text-xs leading-tight break-words",style:{color:"#6C757D"},children:"Supports .xlsx, .xls, .csv files"})]})]})]}),e.jsx("div",{className:"bg-yellow-100 p-3 border-l-4",style:{borderColor:"#FF8C42"},children:e.jsxs("p",{className:"text-xs",style:{color:"#3C3C3C"},children:[e.jsx("strong",{children:"Note:"})," The Excel file should contain columns for Name, Age, Gender, ID Number, Primary Diagnosis, Secondary Diagnosis, Date of Enrollment, Email, DOB, Guardian Name, and Guardian Contact."]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(K,{asChild:!0,children:e.jsx(n,{onClick:I,className:"px-4 py-2",style:{backgroundColor:"#BDC3C7",color:"white",border:"none"},children:"Cancel"})})})]})]}),e.jsx(u,{open:B,onOpenChange:m,children:e.jsxs(y,{className:"max-w-md bg-white rounded-lg border-2",style:{backgroundColor:"white",borderColor:"#BDC3C7"},children:[e.jsxs(j,{children:[e.jsx(b,{style:{color:"#3C3C3C"},children:"Photo Update"}),e.jsx(g,{style:{color:"#6C757D"},children:"Photo has been successfully updated."})]}),e.jsx("div",{className:"flex justify-end space-x-3 pt-2",children:e.jsx(n,{onClick:()=>m(!1),className:"px-4 py-2 border-2 transition-all duration-200",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Ok"})})]})}),e.jsxs(n,{onClick:G,className:"flex items-center space-x-2 px-6 py-2 transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Clients"})]})]})]})})}export{ae as ClientPage};
