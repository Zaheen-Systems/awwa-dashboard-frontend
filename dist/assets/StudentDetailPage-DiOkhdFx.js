import{c as at,r as k,u as oe,j as e,D as le,a as ce,b as ie,d as de,e as ue,L as p,I as A,T as be,S as K,f as U,g as Z,h as ee,i as R,B,k as X,l as Y,m as $,n as S,o as y,p as I,q as c,s as nt,t as st,v as we}from"./index-B8PRHD2z.js";import{C as H}from"./checkbox-kT0Z1nYk.js";import{A as je}from"./arrow-left-CR2QchDQ.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=at("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function ot({isOpen:t,onClose:r,onSubmit:a,iepGoals:n,studentId:o}){const i=localStorage.getItem("name"),[d,g]=k.useState({date:"",action:"",trigger:"",source:"",time:"",staff:i||"",gcoClassification:"",iep_goal_id:""}),[w,D]=k.useState(null);k.useEffect(()=>{if(t){const l=localStorage.getItem("name");g({date:"",action:"",trigger:"",source:"",time:"",staff:l||"",gcoClassification:"",iep_goal_id:""})}},[t]);const b=async()=>(await X.get(`/api/students/${o}/gcos`)).data,{data:N}=oe({queryKey:["gcoIds"],queryFn:b}),v=(l,C)=>{g(F=>({...F,[l]:C}))},O=()=>{if(!d.gcoClassification.trim()){D("GCO classification is required.");return}D(null);const l={...d,iepGoal:d.iep_goal_id==="blank"?"":d.iep_goal_id};console.log(l),a(l),r()},m=()=>{r()};return e.jsx(le,{open:t,onOpenChange:r,children:e.jsxs(ce,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",style:{backgroundColor:"white"},children:[e.jsxs(ie,{children:[e.jsx(de,{style:{color:"#3C3C3C"},children:"Add New Behavior Descriptor"}),e.jsx(ue,{style:{color:"#6C757D"},children:"Fill in the details for the new behavior descriptor entry."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"date",style:{color:"#3C3C3C"},children:"Date"}),e.jsx(A,{id:"date",type:"date",value:d.date,onChange:l=>v("date",l.target.value),className:"bg-white border-2 focus:outline-none",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},onFocus:l=>l.target.style.borderColor="#e65039",onBlur:l=>l.target.style.borderColor="#BDC3C7"})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"action",style:{color:"#3C3C3C"},children:"Action"}),e.jsx(be,{id:"action",value:d.action,onChange:l=>v("action",l.target.value),className:"bg-white border-2 focus:outline-none min-h-[60px] resize-none",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},onFocus:l=>l.target.style.borderColor="#e65039",onBlur:l=>l.target.style.borderColor="#BDC3C7",placeholder:"Describe the action observed..."})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"trigger",style:{color:"#3C3C3C"},children:"Trigger"}),e.jsx(be,{id:"trigger",value:d.trigger,onChange:l=>v("trigger",l.target.value),className:"bg-white border-2 focus:outline-none min-h-[60px] resize-none",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},onFocus:l=>l.target.style.borderColor="#e65039",onBlur:l=>l.target.style.borderColor="#BDC3C7",placeholder:"What triggered this behavior..."})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"source",style:{color:"#3C3C3C"},children:"Source"}),e.jsx(A,{id:"source",value:d.source,onChange:l=>v("source",l.target.value),className:"bg-white border-2 focus:outline-none",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},onFocus:l=>l.target.style.borderColor="#e65039",onBlur:l=>l.target.style.borderColor="#BDC3C7",placeholder:"e.g., Snack time, Free play..."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"time",style:{color:"#3C3C3C"},children:"Time"}),e.jsx(A,{id:"time",type:"time",value:d.time,onChange:l=>v("time",l.target.value),className:"bg-white border-2 focus:outline-none",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},onFocus:l=>l.target.style.borderColor="#e65039",onBlur:l=>l.target.style.borderColor="#BDC3C7"}),e.jsx("p",{className:"text-sm mt-1",style:{color:"#6C757D"},children:"Not mandatory"})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"staff",style:{color:"#3C3C3C"},children:"Staff"}),e.jsx(A,{id:"staff",value:d.staff,onChange:l=>v("staff",l.target.value),className:"bg-white border-2 focus:outline-none",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},onFocus:l=>l.target.style.borderColor="#e65039",onBlur:l=>l.target.style.borderColor="#BDC3C7",readOnly:!0}),e.jsx("p",{className:"text-sm mt-1",style:{color:"#6C757D"},children:"Prefilled with name"})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"gcoClassification",style:{color:"#3C3C3C"},children:"GCO classification"}),e.jsxs(K,{value:d.gcoClassification,onValueChange:l=>v("gcoClassification",l),children:[e.jsx(U,{className:"bg-white border-2",style:{borderColor:"#BDC3C7"},children:e.jsx(Z,{placeholder:"Drop down with all GCOs"})}),e.jsx(ee,{className:"bg-white border border-gray-200 shadow-lg rounded-md max-h-60 overflow-y-auto",style:{backgroundColor:"white",borderColor:"#BDC3C7",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},position:"popper",side:"bottom",align:"start",children:N==null?void 0:N.map((l,C)=>e.jsx(R,{value:l,className:"hover:bg-gray-100 focus:bg-gray-100",style:{color:"#3C3C3C"},children:l},C))})]}),w&&e.jsx("p",{className:"text-sm mt-1 text-red-500",children:w})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"iepGoal",style:{color:"#3C3C3C"},children:"IEP Goals"}),e.jsxs(K,{value:d.iep_goal_id,onValueChange:l=>v("iep_goal_id",l),children:[e.jsx(U,{className:"bg-white border-2",style:{borderColor:"#BDC3C7"},children:e.jsx(Z,{placeholder:"Drop down with all IEP goals, include blank"})}),e.jsx(ee,{className:"bg-white border border-gray-200 shadow-lg rounded-md",style:{backgroundColor:"white",borderColor:"#BDC3C7",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},position:"popper",side:"bottom",align:"start",children:n==null?void 0:n.map((l,C)=>e.jsx(R,{value:l.id.toString(),className:"hover:bg-gray-100 focus:bg-gray-100",style:{color:"#3C3C3C"},children:l.description},C))})]})]})]})]}),e.jsxs("div",{className:"flex justify-center space-x-4 pt-4",children:[e.jsx(B,{onClick:m,className:"px-8 py-2 font-medium border-2 transition-all duration-200 hover:opacity-90",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Cancel"}),e.jsx(B,{onClick:O,className:"px-8 py-2 font-medium transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",borderColor:"#e65039"},children:"Submit"})]})]})})}function lt({isOpen:t,onClose:r,onGenerate:a,behaviourDescriptors:n,iepBehaviourDescriptors:o}){const[i,d]=k.useState([]),[g,w]=k.useState([]);k.useEffect(()=>{if(t){const C=n.filter(x=>x.selected),F=o.filter(x=>x.selected);if(C.length>0||F.length>0){const x=[...C,...F];a(x),r();return}d([]),w([])}},[t,n,o,a,r]);const D=(C,F)=>{d(F?x=>[...x,C]:x=>x.filter(T=>T.id!==C.id))},b=(C,F)=>{w(F?x=>[...x,C]:x=>x.filter(T=>T.id!==C.id))},N=C=>i.some(F=>F.id===C.id),v=C=>g.some(F=>F.id===C.id),O=()=>{const C=[...i,...g];a(C),r()},m=()=>{r()},l=i.length+g.length;return e.jsx(le,{open:t,onOpenChange:r,children:e.jsxs(ce,{className:"max-w-[98vw] w-full max-h-[95vh] overflow-y-auto sm:max-w-[90vw] md:max-w-[85vw] lg:max-w-[80vw] xl:max-w-[75vw]",style:{backgroundColor:"white"},children:[e.jsxs(ie,{children:[e.jsx(de,{style:{color:"#3C3C3C"},children:"Select BDs to Export"}),e.jsx(ue,{style:{color:"#6C757D"},children:"Choose which behavior descriptors to include in your report."})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium mb-4",style:{color:"#3C3C3C"},children:["Behaviour descriptors for GCO (",i.length," selected)"]}),e.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",style:{borderColor:"#BDC3C7"},children:e.jsx("div",{className:"overflow-x-auto min-w-full",children:e.jsxs(Y,{className:"w-full",children:[e.jsx($,{children:e.jsxs(S,{className:"border-b-2",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:[e.jsx(y,{className:"w-16 min-w-16",style:{color:"#3C3C3C"},children:"Select"}),e.jsx(y,{className:"w-24 min-w-24",style:{color:"#3C3C3C"},children:"Date"}),e.jsx(y,{className:"w-20 min-w-20",style:{color:"#3C3C3C"},children:"Time"}),e.jsx(y,{className:"w-32 min-w-32",style:{color:"#3C3C3C"},children:"Source"}),e.jsx(y,{className:"w-64 min-w-64",style:{color:"#3C3C3C"},children:"Action"}),e.jsx(y,{className:"w-64 min-w-64",style:{color:"#3C3C3C"},children:"Trigger"}),e.jsx(y,{className:"w-48 min-w-48",style:{color:"#3C3C3C"},children:"Context"}),e.jsx(y,{className:"w-20 min-w-20",style:{color:"#3C3C3C"},children:"GCO"})]})}),e.jsx(I,{children:n.map((C,F)=>{const x=N(C);return e.jsxs(S,{className:F<n.length-1?"border-b":"",style:{borderColor:"#BDC3C7",backgroundColor:x?"#4EAAC9":"transparent"},children:[e.jsx(c,{className:"text-center",children:e.jsx(H,{checked:x,onCheckedChange:T=>D(C,T),className:"border-2",style:{borderColor:x?"#e65039":"#BDC3C7",backgroundColor:x?"#e65039":"transparent"}})}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},children:C.date}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},children:C.time}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},children:C.source}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},className:"max-w-64 truncate",children:e.jsx("div",{title:C.action,children:C.action})}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},className:"max-w-64 truncate",children:e.jsx("div",{title:C.trigger,children:C.trigger})}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},className:"max-w-48 truncate",children:e.jsx("div",{title:C.context,children:C.context})}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},children:C.gco_classification})]},C.id)})})]})})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium mb-4",style:{color:"#3C3C3C"},children:["Behaviour descriptors for IEP (",g.length," selected)"]}),e.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",style:{borderColor:"#BDC3C7"},children:e.jsx("div",{className:"overflow-x-auto min-w-full",children:e.jsxs(Y,{className:"w-full",children:[e.jsx($,{children:e.jsxs(S,{className:"border-b-2",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:[e.jsx(y,{className:"w-16 min-w-16",style:{color:"#3C3C3C"},children:"Select"}),e.jsx(y,{className:"w-24 min-w-24",style:{color:"#3C3C3C"},children:"Date"}),e.jsx(y,{className:"w-20 min-w-20",style:{color:"#3C3C3C"},children:"Time"}),e.jsx(y,{className:"w-32 min-w-32",style:{color:"#3C3C3C"},children:"Source"}),e.jsx(y,{className:"w-56 min-w-56",style:{color:"#3C3C3C"},children:"Action"}),e.jsx(y,{className:"w-56 min-w-56",style:{color:"#3C3C3C"},children:"Trigger"}),e.jsx(y,{className:"w-40 min-w-40",style:{color:"#3C3C3C"},children:"Context"}),e.jsx(y,{className:"w-32 min-w-32",style:{color:"#3C3C3C"},children:"IEP Goal"}),e.jsx(y,{className:"w-20 min-w-20",style:{color:"#3C3C3C"},children:"GCO"})]})}),e.jsx(I,{children:o.map((C,F)=>{var T;const x=v(C);return e.jsxs(S,{className:F<o.length-1?"border-b":"",style:{borderColor:"#BDC3C7",backgroundColor:x?"#e65039":"transparent"},children:[e.jsx(c,{className:"text-center",children:e.jsx(H,{checked:x,onCheckedChange:_=>b(C,_),className:"border-2",style:{borderColor:x?"#e65039":"#BDC3C7",backgroundColor:x?"#e65039":"transparent"}})}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},children:C.date}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},children:C.time}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},children:C.source}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},className:"max-w-56 truncate",children:e.jsx("div",{title:C.action,children:C.action})}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},className:"max-w-56 truncate",children:e.jsx("div",{title:C.trigger,children:C.trigger})}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},className:"max-w-40 truncate",children:e.jsx("div",{title:C.context,children:C.context})}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},children:(T=C.iepGoal)==null?void 0:T.description}),e.jsx(c,{style:{color:x?"white":"#3C3C3C"},children:C==null?void 0:C.gco_classification})]},C.id)})})]})})})]})]}),e.jsxs("div",{className:"flex justify-center space-x-4 pt-4",children:[e.jsx(B,{onClick:m,className:"px-8 py-2 font-medium border-2 transition-all duration-200 hover:opacity-90",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Cancel"}),e.jsxs(B,{onClick:O,disabled:l===0,className:"px-8 py-2 font-medium transition-all duration-200 hover:opacity-90 disabled:opacity-50",style:{backgroundColor:l>0?"#e65039":"#BDC3C7",color:"white",borderColor:l>0?"#e65039":"#BDC3C7"},children:["Generate (",l," selected)"]})]})]})})}const ne={trigger:"",source:"all",context:"",startDate:"",endDate:"",gcoClassification:"all",hasAction:!1,hasTrigger:!1};function ve({isOpen:t,onClose:r,onApplyFilters:a,onClearFilters:n,behaviorDescriptors:o,title:i}){const[d,g]=k.useState(ne),w=Array.from(new Set(o.map(m=>m.source).filter(Boolean))),D=Array.from(new Set(o.map(m=>m.gco_classification).filter(Boolean))),b=(m,l)=>{g(C=>({...C,[m]:l}))},N=()=>{a(d),r()},v=()=>{g(ne),n(),r()},O=()=>{g(ne),r()};return e.jsx(le,{open:t,onOpenChange:O,children:e.jsxs(ce,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",style:{backgroundColor:"white",zIndex:9999},children:[e.jsxs(ie,{children:[e.jsxs(de,{className:"text-lg font-semibold",style:{color:"#3C3C3C"},children:["Filter ",i]}),e.jsx(ue,{style:{color:"#6C757D"},children:"Use the filters below to narrow down the behavior descriptors based on your criteria."})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"source-filter",className:"text-sm font-medium",style:{color:"#3C3C3C"},children:"Source"}),e.jsxs(K,{value:d.source,onValueChange:m=>b("source",m),children:[e.jsx(U,{className:"mt-1",children:e.jsx(Z,{placeholder:"Select source"})}),e.jsxs(ee,{className:"z-[10000] bg-white border border-gray-200 shadow-lg",children:[e.jsx(R,{value:"all",className:"hover:bg-gray-100 focus:bg-gray-100",children:"All Sources"}),w.map(m=>e.jsx(R,{value:m,className:"hover:bg-gray-100 focus:bg-gray-100",children:m},m))]})]})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"trigger-filter",className:"text-sm font-medium",style:{color:"#3C3C3C"},children:"Trigger"}),e.jsx(A,{id:"trigger-filter",type:"text",placeholder:"Filter by trigger...",value:d.trigger,onChange:m=>b("trigger",m.target.value),className:"mt-1"}),e.jsx("p",{className:"text-xs mt-1",style:{color:"#6C757D"},children:'Example: "during playtime", "when asked to clean up", "at meal time"'})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"context-filter",className:"text-sm font-medium",style:{color:"#3C3C3C"},children:"Context"}),e.jsx(A,{id:"context-filter",type:"text",placeholder:"Filter by context...",value:d.context,onChange:m=>b("context",m.target.value),className:"mt-1"}),e.jsx("p",{className:"text-xs mt-1",style:{color:"#6C757D"},children:'Example: "During free play", "In the classroom", "At circle time", "During transitions"'})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"gco-filter",className:"text-sm font-medium",style:{color:"#3C3C3C"},children:"GCO Classification"}),e.jsxs(K,{value:d.gcoClassification,onValueChange:m=>b("gcoClassification",m),children:[e.jsx(U,{className:"mt-1",children:e.jsx(Z,{placeholder:"Select GCO"})}),e.jsxs(ee,{className:"z-[10000] bg-white border border-gray-200 shadow-lg",children:[e.jsx(R,{value:"all",className:"hover:bg-gray-100 focus:bg-gray-100",children:"All GCOs"}),D.map(m=>e.jsxs(R,{value:m,className:"hover:bg-gray-100 focus:bg-gray-100",children:["GCO ",m]},m))]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"start-date-filter",className:"text-sm font-medium",style:{color:"#3C3C3C"},children:"Start Date"}),e.jsx(A,{id:"start-date-filter",type:"date",value:d.startDate,onChange:m=>b("startDate",m.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"end-date-filter",className:"text-sm font-medium",style:{color:"#3C3C3C"},children:"End Date"}),e.jsx(A,{id:"end-date-filter",type:"date",value:d.endDate,onChange:m=>b("endDate",m.target.value),className:"mt-1"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(p,{className:"text-sm font-medium",style:{color:"#3C3C3C"},children:"Additional Filters"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{id:"has-action",checked:d.hasAction,onCheckedChange:m=>b("hasAction",m)}),e.jsx(p,{htmlFor:"has-action",className:"text-sm",style:{color:"#3C3C3C"},children:"Only show entries with actions"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{id:"has-trigger",checked:d.hasTrigger,onCheckedChange:m=>b("hasTrigger",m)}),e.jsx(p,{htmlFor:"has-trigger",className:"text-sm",style:{color:"#3C3C3C"},children:"Only show entries with triggers"})]})]})]})]}),e.jsxs(nt,{className:"flex justify-between",children:[e.jsx(B,{variant:"outline",onClick:v,className:"px-6",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Clear All"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(B,{variant:"outline",onClick:O,className:"px-6",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Cancel"}),e.jsx(B,{onClick:N,className:"px-6",style:{backgroundColor:"#e65039",color:"white",borderColor:"#e65039"},children:"Apply Filters"})]})]})]})})}const Pe=6048e5,ct=864e5,De=Symbol.for("constructDateFrom");function W(t,r){return typeof t=="function"?t(r):t&&typeof t=="object"&&De in t?t[De](r):t instanceof Date?new t.constructor(r):new Date(r)}function M(t,r){return W(r||t,t)}let it={};function re(){return it}function V(t,r){var g,w,D,b;const a=re(),n=(r==null?void 0:r.weekStartsOn)??((w=(g=r==null?void 0:r.locale)==null?void 0:g.options)==null?void 0:w.weekStartsOn)??a.weekStartsOn??((b=(D=a.locale)==null?void 0:D.options)==null?void 0:b.weekStartsOn)??0,o=M(t,r==null?void 0:r.in),i=o.getDay(),d=(i<n?7:0)+i-n;return o.setDate(o.getDate()-d),o.setHours(0,0,0,0),o}function te(t,r){return V(t,{...r,weekStartsOn:1})}function Me(t,r){const a=M(t,r==null?void 0:r.in),n=a.getFullYear(),o=W(a,0);o.setFullYear(n+1,0,4),o.setHours(0,0,0,0);const i=te(o),d=W(a,0);d.setFullYear(n,0,4),d.setHours(0,0,0,0);const g=te(d);return a.getTime()>=i.getTime()?n+1:a.getTime()>=g.getTime()?n:n-1}function Ne(t){const r=M(t),a=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return a.setUTCFullYear(r.getFullYear()),+t-+a}function dt(t,...r){const a=W.bind(null,r.find(n=>typeof n=="object"));return r.map(a)}function pe(t,r){const a=M(t,r==null?void 0:r.in);return a.setHours(0,0,0,0),a}function ut(t,r,a){const[n,o]=dt(a==null?void 0:a.in,t,r),i=pe(n),d=pe(o),g=+i-Ne(i),w=+d-Ne(d);return Math.round((g-w)/ct)}function ht(t,r){const a=Me(t,r),n=W(t,0);return n.setFullYear(a,0,4),n.setHours(0,0,0,0),te(n)}function Ct(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function mt(t){return!(!Ct(t)&&typeof t!="number"||isNaN(+M(t)))}function gt(t,r){const a=M(t,r==null?void 0:r.in);return a.setFullYear(a.getFullYear(),0,1),a.setHours(0,0,0,0),a}const ft={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},xt=(t,r,a)=>{let n;const o=ft[t];return typeof o=="string"?n=o:r===1?n=o.one:n=o.other.replace("{{count}}",r.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+n:n+" ago":n};function se(t){return(r={})=>{const a=r.width?String(r.width):t.defaultWidth;return t.formats[a]||t.formats[t.defaultWidth]}}const yt={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},bt={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},wt={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},jt={date:se({formats:yt,defaultWidth:"full"}),time:se({formats:bt,defaultWidth:"full"}),dateTime:se({formats:wt,defaultWidth:"full"})},vt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Dt=(t,r,a,n)=>vt[t];function L(t){return(r,a)=>{const n=a!=null&&a.context?String(a.context):"standalone";let o;if(n==="formatting"&&t.formattingValues){const d=t.defaultFormattingWidth||t.defaultWidth,g=a!=null&&a.width?String(a.width):d;o=t.formattingValues[g]||t.formattingValues[d]}else{const d=t.defaultWidth,g=a!=null&&a.width?String(a.width):t.defaultWidth;o=t.values[g]||t.values[d]}const i=t.argumentCallback?t.argumentCallback(r):r;return o[i]}}const Nt={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},pt={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Ft={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},kt={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},St={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ot={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Bt=(t,r)=>{const a=Number(t),n=a%100;if(n>20||n<10)switch(n%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},Pt={ordinalNumber:Bt,era:L({values:Nt,defaultWidth:"wide"}),quarter:L({values:pt,defaultWidth:"wide",argumentCallback:t=>t-1}),month:L({values:Ft,defaultWidth:"wide"}),day:L({values:kt,defaultWidth:"wide"}),dayPeriod:L({values:St,defaultWidth:"wide",formattingValues:Ot,defaultFormattingWidth:"wide"})};function Q(t){return(r,a={})=>{const n=a.width,o=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=r.match(o);if(!i)return null;const d=i[0],g=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],w=Array.isArray(g)?Tt(g,N=>N.test(d)):Mt(g,N=>N.test(d));let D;D=t.valueCallback?t.valueCallback(w):w,D=a.valueCallback?a.valueCallback(D):D;const b=r.slice(d.length);return{value:D,rest:b}}}function Mt(t,r){for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&r(t[a]))return a}function Tt(t,r){for(let a=0;a<t.length;a++)if(r(t[a]))return a}function At(t){return(r,a={})=>{const n=r.match(t.matchPattern);if(!n)return null;const o=n[0],i=r.match(t.parsePattern);if(!i)return null;let d=t.valueCallback?t.valueCallback(i[0]):i[0];d=a.valueCallback?a.valueCallback(d):d;const g=r.slice(o.length);return{value:d,rest:g}}}const _t=/^(\d+)(th|st|nd|rd)?/i,Et=/\d+/i,Wt={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Gt={any:[/^b/i,/^(a|c)/i]},Yt={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},It={any:[/1/i,/2/i,/3/i,/4/i]},qt={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Rt={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Ht={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Lt={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Qt={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},$t={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Xt={ordinalNumber:At({matchPattern:_t,parsePattern:Et,valueCallback:t=>parseInt(t,10)}),era:Q({matchPatterns:Wt,defaultMatchWidth:"wide",parsePatterns:Gt,defaultParseWidth:"any"}),quarter:Q({matchPatterns:Yt,defaultMatchWidth:"wide",parsePatterns:It,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Q({matchPatterns:qt,defaultMatchWidth:"wide",parsePatterns:Rt,defaultParseWidth:"any"}),day:Q({matchPatterns:Ht,defaultMatchWidth:"wide",parsePatterns:Lt,defaultParseWidth:"any"}),dayPeriod:Q({matchPatterns:Qt,defaultMatchWidth:"any",parsePatterns:$t,defaultParseWidth:"any"})},Vt={code:"en-US",formatDistance:xt,formatLong:jt,formatRelative:Dt,localize:Pt,match:Xt,options:{weekStartsOn:0,firstWeekContainsDate:1}};function zt(t,r){const a=M(t,r==null?void 0:r.in);return ut(a,gt(a))+1}function Jt(t,r){const a=M(t,r==null?void 0:r.in),n=+te(a)-+ht(a);return Math.round(n/Pe)+1}function Te(t,r){var b,N,v,O;const a=M(t,r==null?void 0:r.in),n=a.getFullYear(),o=re(),i=(r==null?void 0:r.firstWeekContainsDate)??((N=(b=r==null?void 0:r.locale)==null?void 0:b.options)==null?void 0:N.firstWeekContainsDate)??o.firstWeekContainsDate??((O=(v=o.locale)==null?void 0:v.options)==null?void 0:O.firstWeekContainsDate)??1,d=W((r==null?void 0:r.in)||t,0);d.setFullYear(n+1,0,i),d.setHours(0,0,0,0);const g=V(d,r),w=W((r==null?void 0:r.in)||t,0);w.setFullYear(n,0,i),w.setHours(0,0,0,0);const D=V(w,r);return+a>=+g?n+1:+a>=+D?n:n-1}function Kt(t,r){var g,w,D,b;const a=re(),n=(r==null?void 0:r.firstWeekContainsDate)??((w=(g=r==null?void 0:r.locale)==null?void 0:g.options)==null?void 0:w.firstWeekContainsDate)??a.firstWeekContainsDate??((b=(D=a.locale)==null?void 0:D.options)==null?void 0:b.firstWeekContainsDate)??1,o=Te(t,r),i=W((r==null?void 0:r.in)||t,0);return i.setFullYear(o,0,n),i.setHours(0,0,0,0),V(i,r)}function Ut(t,r){const a=M(t,r==null?void 0:r.in),n=+V(a,r)-+Kt(a,r);return Math.round(n/Pe)+1}function j(t,r){const a=t<0?"-":"",n=Math.abs(t).toString().padStart(r,"0");return a+n}const E={y(t,r){const a=t.getFullYear(),n=a>0?a:1-a;return j(r==="yy"?n%100:n,r.length)},M(t,r){const a=t.getMonth();return r==="M"?String(a+1):j(a+1,2)},d(t,r){return j(t.getDate(),r.length)},a(t,r){const a=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(t,r){return j(t.getHours()%12||12,r.length)},H(t,r){return j(t.getHours(),r.length)},m(t,r){return j(t.getMinutes(),r.length)},s(t,r){return j(t.getSeconds(),r.length)},S(t,r){const a=r.length,n=t.getMilliseconds(),o=Math.trunc(n*Math.pow(10,a-3));return j(o,r.length)}},q={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Fe={G:function(t,r,a){const n=t.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return a.era(n,{width:"abbreviated"});case"GGGGG":return a.era(n,{width:"narrow"});case"GGGG":default:return a.era(n,{width:"wide"})}},y:function(t,r,a){if(r==="yo"){const n=t.getFullYear(),o=n>0?n:1-n;return a.ordinalNumber(o,{unit:"year"})}return E.y(t,r)},Y:function(t,r,a,n){const o=Te(t,n),i=o>0?o:1-o;if(r==="YY"){const d=i%100;return j(d,2)}return r==="Yo"?a.ordinalNumber(i,{unit:"year"}):j(i,r.length)},R:function(t,r){const a=Me(t);return j(a,r.length)},u:function(t,r){const a=t.getFullYear();return j(a,r.length)},Q:function(t,r,a){const n=Math.ceil((t.getMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return j(n,2);case"Qo":return a.ordinalNumber(n,{unit:"quarter"});case"QQQ":return a.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,r,a){const n=Math.ceil((t.getMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return j(n,2);case"qo":return a.ordinalNumber(n,{unit:"quarter"});case"qqq":return a.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,r,a){const n=t.getMonth();switch(r){case"M":case"MM":return E.M(t,r);case"Mo":return a.ordinalNumber(n+1,{unit:"month"});case"MMM":return a.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(n,{width:"wide",context:"formatting"})}},L:function(t,r,a){const n=t.getMonth();switch(r){case"L":return String(n+1);case"LL":return j(n+1,2);case"Lo":return a.ordinalNumber(n+1,{unit:"month"});case"LLL":return a.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(n,{width:"wide",context:"standalone"})}},w:function(t,r,a,n){const o=Ut(t,n);return r==="wo"?a.ordinalNumber(o,{unit:"week"}):j(o,r.length)},I:function(t,r,a){const n=Jt(t);return r==="Io"?a.ordinalNumber(n,{unit:"week"}):j(n,r.length)},d:function(t,r,a){return r==="do"?a.ordinalNumber(t.getDate(),{unit:"date"}):E.d(t,r)},D:function(t,r,a){const n=zt(t);return r==="Do"?a.ordinalNumber(n,{unit:"dayOfYear"}):j(n,r.length)},E:function(t,r,a){const n=t.getDay();switch(r){case"E":case"EE":case"EEE":return a.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(n,{width:"short",context:"formatting"});case"EEEE":default:return a.day(n,{width:"wide",context:"formatting"})}},e:function(t,r,a,n){const o=t.getDay(),i=(o-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(i);case"ee":return j(i,2);case"eo":return a.ordinalNumber(i,{unit:"day"});case"eee":return a.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(o,{width:"short",context:"formatting"});case"eeee":default:return a.day(o,{width:"wide",context:"formatting"})}},c:function(t,r,a,n){const o=t.getDay(),i=(o-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(i);case"cc":return j(i,r.length);case"co":return a.ordinalNumber(i,{unit:"day"});case"ccc":return a.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(o,{width:"narrow",context:"standalone"});case"cccccc":return a.day(o,{width:"short",context:"standalone"});case"cccc":default:return a.day(o,{width:"wide",context:"standalone"})}},i:function(t,r,a){const n=t.getDay(),o=n===0?7:n;switch(r){case"i":return String(o);case"ii":return j(o,r.length);case"io":return a.ordinalNumber(o,{unit:"day"});case"iii":return a.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(n,{width:"short",context:"formatting"});case"iiii":default:return a.day(n,{width:"wide",context:"formatting"})}},a:function(t,r,a){const o=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(t,r,a){const n=t.getHours();let o;switch(n===12?o=q.noon:n===0?o=q.midnight:o=n/12>=1?"pm":"am",r){case"b":case"bb":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(t,r,a){const n=t.getHours();let o;switch(n>=17?o=q.evening:n>=12?o=q.afternoon:n>=4?o=q.morning:o=q.night,r){case"B":case"BB":case"BBB":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(t,r,a){if(r==="ho"){let n=t.getHours()%12;return n===0&&(n=12),a.ordinalNumber(n,{unit:"hour"})}return E.h(t,r)},H:function(t,r,a){return r==="Ho"?a.ordinalNumber(t.getHours(),{unit:"hour"}):E.H(t,r)},K:function(t,r,a){const n=t.getHours()%12;return r==="Ko"?a.ordinalNumber(n,{unit:"hour"}):j(n,r.length)},k:function(t,r,a){let n=t.getHours();return n===0&&(n=24),r==="ko"?a.ordinalNumber(n,{unit:"hour"}):j(n,r.length)},m:function(t,r,a){return r==="mo"?a.ordinalNumber(t.getMinutes(),{unit:"minute"}):E.m(t,r)},s:function(t,r,a){return r==="so"?a.ordinalNumber(t.getSeconds(),{unit:"second"}):E.s(t,r)},S:function(t,r){return E.S(t,r)},X:function(t,r,a){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(r){case"X":return Se(n);case"XXXX":case"XX":return G(n);case"XXXXX":case"XXX":default:return G(n,":")}},x:function(t,r,a){const n=t.getTimezoneOffset();switch(r){case"x":return Se(n);case"xxxx":case"xx":return G(n);case"xxxxx":case"xxx":default:return G(n,":")}},O:function(t,r,a){const n=t.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+ke(n,":");case"OOOO":default:return"GMT"+G(n,":")}},z:function(t,r,a){const n=t.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+ke(n,":");case"zzzz":default:return"GMT"+G(n,":")}},t:function(t,r,a){const n=Math.trunc(+t/1e3);return j(n,r.length)},T:function(t,r,a){return j(+t,r.length)}};function ke(t,r=""){const a=t>0?"-":"+",n=Math.abs(t),o=Math.trunc(n/60),i=n%60;return i===0?a+String(o):a+String(o)+r+j(i,2)}function Se(t,r){return t%60===0?(t>0?"-":"+")+j(Math.abs(t)/60,2):G(t,r)}function G(t,r=""){const a=t>0?"-":"+",n=Math.abs(t),o=j(Math.trunc(n/60),2),i=j(n%60,2);return a+o+r+i}const Oe=(t,r)=>{switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},Ae=(t,r)=>{switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},Zt=(t,r)=>{const a=t.match(/(P+)(p+)?/)||[],n=a[1],o=a[2];if(!o)return Oe(t,r);let i;switch(n){case"P":i=r.dateTime({width:"short"});break;case"PP":i=r.dateTime({width:"medium"});break;case"PPP":i=r.dateTime({width:"long"});break;case"PPPP":default:i=r.dateTime({width:"full"});break}return i.replace("{{date}}",Oe(n,r)).replace("{{time}}",Ae(o,r))},er={p:Ae,P:Zt},tr=/^D+$/,rr=/^Y+$/,ar=["D","DD","YY","YYYY"];function nr(t){return tr.test(t)}function sr(t){return rr.test(t)}function or(t,r,a){const n=lr(t,r,a);if(console.warn(n),ar.includes(t))throw new RangeError(n)}function lr(t,r,a){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${r}\`) for formatting ${n} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const cr=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ir=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,dr=/^'([^]*?)'?$/,ur=/''/g,hr=/[a-zA-Z]/;function Be(t,r,a){var b,N,v,O;const n=re(),o=n.locale??Vt,i=n.firstWeekContainsDate??((N=(b=n.locale)==null?void 0:b.options)==null?void 0:N.firstWeekContainsDate)??1,d=n.weekStartsOn??((O=(v=n.locale)==null?void 0:v.options)==null?void 0:O.weekStartsOn)??0,g=M(t,a==null?void 0:a.in);if(!mt(g))throw new RangeError("Invalid time value");let w=r.match(ir).map(m=>{const l=m[0];if(l==="p"||l==="P"){const C=er[l];return C(m,o.formatLong)}return m}).join("").match(cr).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const l=m[0];if(l==="'")return{isToken:!1,value:Cr(m)};if(Fe[l])return{isToken:!0,value:m};if(l.match(hr))throw new RangeError("Format string contains an unescaped latin alphabet character `"+l+"`");return{isToken:!1,value:m}});o.localize.preprocessor&&(w=o.localize.preprocessor(g,w));const D={firstWeekContainsDate:i,weekStartsOn:d,locale:o};return w.map(m=>{if(!m.isToken)return m.value;const l=m.value;(sr(l)||nr(l))&&or(l,r,String(t));const C=Fe[l[0]];return C(g,l,o.localize,D)}).join("")}function Cr(t){const r=t.match(dr);return r?r[1].replace(ur,"'"):t}function mr(t){return oe({queryKey:["behavioralDescriptors",t],queryFn:async()=>{const{data:r}=await X.get(`/api/students/${t}/behavioral_descriptors`);return r.map(a=>{const n=new Date(a.created_at);return{...a,selected:!1,date:Be(n,"dd.MM.yy"),time:Be(n,"h:mm a")}})}})}const gr=async t=>{const{data:r}=await X.get(`/api/behavioral-descriptors/grouped_gcos/${t}`);return r};function br({student:t,onBack:r,onBehaviorDescriptorClick:a}){var ye;const[n,o]=k.useState(""),[i,d]=k.useState(""),[g,w]=k.useState(!1),D=st(),[b,N]=k.useState([]),[v,O]=k.useState([]),{data:m}=mr(parseInt(t.id)),[l,C]=k.useState({trigger:"",source:"all",context:"",startDate:"",endDate:"",gcoClassification:"all",hasAction:!1,hasTrigger:!1}),[F,x]=k.useState({trigger:"",source:"all",context:"",startDate:"",endDate:"",gcoClassification:"all",hasAction:!1,hasTrigger:!1}),T=s=>!n&&!i?s:s.filter(u=>{const h=new Date(u.created_at),f=n?new Date(n):null,P=i?new Date(i):null;if(g){if(f&&P)return h>=f&&h<=P;if(f)return h>=f;if(P)return h<=P}else if(f&&!P){const z=h.toISOString().split("T")[0],rt=f.toISOString().split("T")[0];return z===rt}else if(f&&P)return h>=f&&h<=P;return!0});k.useEffect(()=>{if(m){const s=T(m),u=fe(s.filter(f=>!f.iep_goal),l);N(u);const h=fe(s.filter(f=>!!f.iep_goal),F);O(h)}},[m,n,i,g,l,F]);const{data:_}=oe({queryKey:["groupedDescriptors",t.id],queryFn:()=>gr(parseInt(t.id)),enabled:!!t.id}),ae=s=>b?b.filter(h=>!h.action||h.action.trim()===""||!h.trigger||h.trigger.trim()===""?!1:String(h.gco_classification)===String(s)).length:0,[_e,he]=k.useState(!1),[Ee,We]=k.useState(!1),[Ge,Ce]=k.useState(!1),[Ye,me]=k.useState(!1),Ie=(s,u)=>{console.log(s,u),N(h=>h.map(f=>f.id===s?{...f,selected:u}:f))},qe=(s,u)=>{console.log(s,u),O(h=>h.map(f=>f.id===s?{...f,selected:u}:f))},ge=(s,u)=>{u.target.closest('input[type="checkbox"]')||u.target.closest('[role="checkbox"]')||a(s)},Re=()=>{he(!0)},He=async s=>{const u={source:s.source,action:s.action,trigger:s.trigger,timestamp:s.time,gco_classification:s.gcoClassification,iep_goal_id:Number(s.iep_goal_id),student_id:t.id};return(await X.post("/api/behavioral-descriptors/",u)).data},Le=()=>we({mutationFn:He}),{mutate:Qe}=Le(),$e=s=>{console.log("Team Member BD submitted:",s),Qe(s,{onSuccess:u=>{console.log("BD saved:",u),D.invalidateQueries({queryKey:["behavioralDescriptors",parseInt(t.id)]})},onError:u=>{console.error("Error saving BD:",u)}})},Xe=()=>{o(""),d(""),w(!1)},fe=(s,u)=>s.filter(h=>{if(u.trigger&&!h.trigger.toLowerCase().includes(u.trigger.toLowerCase())||u.source&&u.source!=="all"&&h.source!==u.source||u.context&&!h.context.toLowerCase().includes(u.context.toLowerCase())||u.gcoClassification&&u.gcoClassification!=="all"&&h.gco_classification!==u.gcoClassification)return!1;if(u.startDate||u.endDate){const f=new Date(h.created_at),P=u.startDate?new Date(u.startDate):null,z=u.endDate?new Date(u.endDate):null;if(P&&f<P||z&&f>z)return!1}return!(u.hasAction&&(!h.action||h.action.trim()==="")||u.hasTrigger&&(!h.trigger||h.trigger.trim()===""))}),Ve=s=>{C(s)},ze=()=>{C({trigger:"",source:"all",context:"",startDate:"",endDate:"",gcoClassification:"all",hasAction:!1,hasTrigger:!1})},Je=s=>{x(s)},Ke=()=>{x({trigger:"",source:"all",context:"",startDate:"",endDate:"",gcoClassification:"all",hasAction:!1,hasTrigger:!1})},Ue=()=>{const s=b.filter(f=>f.selected).map(f=>f.id),u=v.filter(f=>f.selected).map(f=>f.id),h=[...s,...u];console.log(h),et({studentId:t.id,ids:h})};function Ze(){return we({mutationFn:async({studentId:s,ids:u})=>{const h=u&&u.length>0?`?${u.map(P=>`ids=${P}`).join("&")}`:"";return(await X.get(`/api/students/${s}/gcowmr${h}`)).data},onSuccess:s=>{const{download_url:u}=s;if(!u)return;const h=document.createElement("a");h.href=u,h.setAttribute("download","report.xlsx"),document.body.appendChild(h),h.click(),h.remove()}})}const{mutate:et,isPending:xe}=Ze(),tt=s=>{console.log(s)};return e.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"#F8F9FA"},children:[e.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6 lg:py-8",style:{backgroundColor:"#fff5f3"},children:e.jsx("div",{className:"max-w-7xl mx-auto"})}),e.jsx("div",{className:"px-4 sm:px-6 py-2",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{className:"w-4 h-4",style:{color:"#e65039"}}),e.jsxs("span",{style:{color:"#e65039"},children:["Home > ",t==null?void 0:t.name]})]}),e.jsxs(B,{onClick:r,className:"flex items-center space-x-2 px-6 py-2 font-medium transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",borderColor:"#e65039"},children:[e.jsx(je,{className:"w-5 h-5"}),e.jsx("span",{children:"Back"})]})]})})}),e.jsx("div",{className:"px-4 sm:px-6 pb-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-6",children:e.jsx(Y,{children:e.jsxs(I,{children:[e.jsxs(S,{className:"border-b",style:{borderColor:"#BDC3C7"},children:[e.jsx(c,{className:"font-medium",style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:"Name"}),e.jsx(c,{style:{color:"#3C3C3C"},children:t==null?void 0:t.name}),e.jsx(c,{className:"font-medium",style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:"Chronological age (months)"}),e.jsx(c,{style:{color:"#3C3C3C"},children:t==null?void 0:t.chronological_age})]}),e.jsxs(S,{className:"border-b",style:{borderColor:"#BDC3C7"},children:[e.jsx(c,{className:"font-medium",style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:"Primary Diagnosis"}),e.jsx(c,{style:{color:"#3C3C3C"},children:t==null?void 0:t.primary_diagnosis}),e.jsx(c,{className:"font-medium",style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:"Age band (months)"}),e.jsx(c,{style:{color:"#3C3C3C"},children:t==null?void 0:t.age_band})]}),e.jsxs(S,{className:"border-b",style:{borderColor:"#BDC3C7"},children:[e.jsx(c,{className:"font-medium",style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:"Secondary Diagnosis"}),e.jsx(c,{style:{color:"#3C3C3C"},children:t==null?void 0:t.secondary_diagnosis}),e.jsx(c,{className:"font-medium",style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:"Functional Age"}),e.jsx(c,{style:{color:"#3C3C3C"}})]}),e.jsxs(S,{className:"border-b",style:{borderColor:"#BDC3C7"},children:[e.jsx(c,{className:"font-medium",style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:"Entry/Review/Exit"}),e.jsx(c,{style:{color:"#3C3C3C"},children:t==null?void 0:t.entry_type}),e.jsx(c,{className:"font-medium",style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:"GCO 1"}),e.jsx(c,{style:{color:"#3C3C3C"},children:t.gco_1_functional_age})]}),e.jsxs(S,{className:"border-b",style:{borderColor:"#BDC3C7"},children:[e.jsx(c,{className:"font-medium",style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:"CT"}),e.jsx(c,{style:{color:"#3C3C3C"},children:(ye=t.ct)==null?void 0:ye.first_name}),e.jsx(c,{className:"font-medium",style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:"GCO 2"}),e.jsx(c,{style:{color:"#3C3C3C"},children:t.gco_2_functional_age})]}),e.jsxs(S,{children:[e.jsx(c,{className:"font-medium",style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:"Last GCO"}),e.jsx(c,{style:{color:"#3C3C3C"},children:t==null?void 0:t.last_gco_date}),e.jsx(c,{className:"font-medium",style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:"GCO 3"}),e.jsx(c,{style:{color:"#3C3C3C"},children:t.gco_3_functional_age})]})]})})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-6",children:[e.jsx("div",{className:"p-4 border-b",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:e.jsx("h3",{className:"font-medium",style:{color:"#3C3C3C"},children:"IEP Goals"})}),e.jsx(Y,{children:e.jsx(I,{children:t.iep_goals.map((s,u)=>e.jsxs(S,{className:u<t.iep_goals.length-1?"border-b":"",style:{borderColor:"#BDC3C7"},children:[e.jsxs(c,{style:{color:"#3C3C3C"},children:[u+1,"."]}),e.jsx(c,{style:{color:"#3C3C3C"},children:s.description}),e.jsxs(c,{style:{color:"#3C3C3C",backgroundColor:"#F8F9FA"},children:["GCO ",s.gco_number]})]},s.id))})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(p,{className:"text-sm font-medium",style:{color:"#3C3C3C"},children:"Date Filter Mode:"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(B,{type:"button",variant:g?"outline":"default",size:"sm",onClick:()=>{w(!1),d("")},className:"text-xs",style:{backgroundColor:g?"transparent":"#e65039",color:g?"#3C3C3C":"white",borderColor:"#e65039"},children:"Single Date"}),e.jsx(B,{type:"button",variant:g?"default":"outline",size:"sm",onClick:()=>w(!0),className:"text-xs",style:{backgroundColor:g?"#e65039":"transparent",color:g?"white":"#3C3C3C",borderColor:"#e65039"},children:"Date Range"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(p,{htmlFor:"startDate",style:{color:"#3C3C3C"},children:g?"Start Date":"Date"}),e.jsx(A,{id:"startDate",type:"date",value:n,onChange:s=>o(s.target.value),className:"bg-white border-2 focus:outline-none",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},onFocus:s=>s.target.style.borderColor="#2C5F7C",onBlur:s=>s.target.style.borderColor="#BDC3C7"})]}),g&&e.jsxs("div",{className:"flex-1",children:[e.jsx(p,{htmlFor:"endDate",style:{color:"#3C3C3C"},children:"End Date"}),e.jsx(A,{id:"endDate",type:"date",value:i,onChange:s=>d(s.target.value),className:"bg-white border-2 focus:outline-none",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},onFocus:s=>s.target.style.borderColor="#2C5F7C",onBlur:s=>s.target.style.borderColor="#BDC3C7"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm",style:{color:"#6C757D"},children:g?"Select a date range to filter behavior descriptors":"Select a specific date to view behavior descriptors for that day"}),e.jsx(B,{type:"button",variant:"outline",size:"sm",onClick:Xe,className:"text-xs",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Reset Dates"})]})]})})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-6",children:[e.jsx("div",{className:"p-4 border-b",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:e.jsx("h3",{className:"font-medium",style:{color:"#3C3C3C"},children:"BDs Collected For GCOs"})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:e.jsxs(Y,{children:[e.jsx($,{className:"sticky top-0 bg-white z-10",children:e.jsxs(S,{className:"border-b-2",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:[e.jsx(y,{className:"w-12",style:{color:"#3C3C3C"}}),e.jsx(y,{className:"text-center",style:{color:"#3C3C3C"},children:"GCO 1"}),e.jsx(y,{className:"text-center",style:{color:"#3C3C3C"},children:"GCO 2"}),e.jsx(y,{className:"text-center",style:{color:"#3C3C3C"},children:"GCO 3"})]})}),e.jsx(I,{children:_==null?void 0:_.gco1.map((s,u)=>e.jsxs(S,{className:u<_.gco1.length-1?"border-b":"",style:{borderColor:"#BDC3C7"},children:[e.jsx(c,{className:"w-12 text-center text-sm",style:{color:"#3C3C3C",backgroundColor:"transparent"},children:u+1}),e.jsx(c,{className:"text-center",style:{color:"#3C3C3C",backgroundColor:"transparent"},children:(()=>{const h=_.gco1[u],f=ae(h);return f>0?`${h}(${f})`:h})()}),e.jsx(c,{className:"text-center",style:{color:"#3C3C3C",backgroundColor:"transparent"},children:(()=>{const h=_.gco2[u],f=ae(h);return f>0?`${h}(${f})`:h})()}),e.jsx(c,{className:"text-center",style:{color:"#3C3C3C",backgroundColor:"transparent"},children:(()=>{const h=_.gco3[u],f=ae(h);return f>0?`${h}(${f})`:h})()})]},u))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-6",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:[e.jsx("h3",{className:"font-medium",style:{color:"#3C3C3C"},children:"Behaviour descriptors for GCO"}),e.jsxs(B,{onClick:()=>Ce(!0),variant:"outline",size:"sm",className:"flex items-center space-x-2",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"Filter"})]})]}),e.jsx("div",{className:"max-h-[400px] sm:max-h-[500px] lg:max-h-[600px] overflow-y-auto",children:e.jsxs(Y,{children:[e.jsx($,{className:"sticky top-0 bg-white z-10",children:e.jsxs(S,{className:"border-b-2",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:[e.jsx(y,{className:"w-16",style:{color:"#3C3C3C"},children:"Select"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"Date"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"Time"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"Source"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"Action"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"Trigger"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"Context"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"GCO"})]})}),e.jsx(I,{children:b==null?void 0:b.filter(s=>s.action&&s.action.trim()!==""&&s.trigger&&s.trigger.trim()!=="").map((s,u,h)=>e.jsxs(S,{className:`${u<h.length-1?"border-b":""} cursor-pointer hover:bg-gray-50 transition-colors`,style:{borderColor:"#BDC3C7",backgroundColor:s.selected?"#e65039":"transparent"},onClick:f=>ge(s,f),children:[e.jsx(c,{className:"text-center",children:e.jsx(H,{checked:s.selected,onCheckedChange:f=>Ie(s.id,f),className:"border-2 data-[state=checked]:bg-primary data-[state=checked]:border-primary",style:{borderColor:s.selected?"#e65039":"#BDC3C7",backgroundColor:s.selected?"#e65039":"transparent"}})}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.date}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.time}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.source}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.action}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.trigger}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.context}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.gco_classification})]},s.id))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-6",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:[e.jsx("h3",{className:"font-medium",style:{color:"#3C3C3C"},children:"Behaviour descriptors for IEP"}),e.jsxs(B,{onClick:()=>me(!0),variant:"outline",size:"sm",className:"flex items-center space-x-2",style:{borderColor:"#BDC3C7",color:"#3C3C3C"},children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"Filter"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Y,{children:[e.jsx($,{children:e.jsxs(S,{className:"border-b-2",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:[e.jsx(y,{className:"w-16",style:{color:"#3C3C3C"},children:"Select"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"Date"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"Time"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"Source"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"Action"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"Trigger"}),e.jsx(y,{style:{color:"#3C3C3C"},children:"Source"}),e.jsx(y,{style:{color:"#3C3C3C"},children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"IEP Goal"}),e.jsx(J,{className:"w-4 h-4",style:{color:"#6C757D"}})]})}),e.jsx(y,{style:{color:"#3C3C3C"},children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"GCO"}),e.jsx(J,{className:"w-4 h-4",style:{color:"#6C757D"}})]})})]})}),e.jsx(I,{children:v==null?void 0:v.map((s,u)=>e.jsxs(S,{className:`${u<v.length-1?"border-b":""} cursor-pointer hover:bg-gray-50 transition-colors`,style:{borderColor:"#BDC3C7",backgroundColor:s.selected?"#e65039":"transparent"},onClick:h=>ge(s,h),children:[e.jsx(c,{className:"text-center",children:e.jsx(H,{checked:s.selected,onCheckedChange:h=>qe(s.id,h),className:"border-2 data-[state=checked]:bg-primary data-[state=checked]:border-primary",style:{borderColor:s.selected?"#e65039":"#BDC3C7",backgroundColor:s.selected?"#e65039":"transparent"}})}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.date}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.time}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.source}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.action}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.trigger}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.context}),e.jsx(c,{style:{color:s.selected?"white":"#3C3C3C"},children:s.iep_goal?`Goal ${t.iep_goals.findIndex(h=>{var f;return h.id===((f=s.iep_goal)==null?void 0:f.id)})+1}`:"N/A"}),e.jsxs(c,{style:{color:s.selected?"white":"#3C3C3C"},children:["GCO ",s.gco_classification]})]},s.id))})]})})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[e.jsx(B,{onClick:Re,className:"px-6 py-2 font-medium transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",borderColor:"#e65039"},children:"Add New BDs"}),e.jsx(B,{onClick:Ue,className:"px-6 py-2 font-medium transition-all duration-200 hover:opacity-90",disabled:xe,style:{backgroundColor:"#e65039",color:"white",borderColor:"#e65039"},children:xe?"Generating...":"Generate Report"})]})]})}),e.jsx(ot,{isOpen:_e,onClose:()=>he(!1),onSubmit:$e,iepGoals:t.iep_goals,studentId:t.id}),e.jsx(lt,{isOpen:Ee,onClose:()=>We(!1),behaviourDescriptors:b||[],iepBehaviourDescriptors:v||[],onGenerate:tt}),e.jsx(ve,{isOpen:Ge,onClose:()=>Ce(!1),onApplyFilters:Ve,onClearFilters:ze,behaviorDescriptors:m||[],title:"GCO Behaviour Descriptors"}),e.jsx(ve,{isOpen:Ye,onClose:()=>me(!1),onApplyFilters:Je,onClearFilters:Ke,behaviorDescriptors:m||[],title:"IEP Behaviour Descriptors"})]})}export{br as StudentDetailPage};
