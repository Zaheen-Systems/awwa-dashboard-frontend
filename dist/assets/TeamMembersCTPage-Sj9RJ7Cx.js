import{r as d,t as W,j as e,l as I,m as O,n as k,o as a,p as _,q as t,D as m,W as D,a as p,b as u,d as j,e as y,B as c,X as A,Q as X}from"./index-C_w9ghux.js";import{b as Y}from"./useUsers-BMoKEb3v.js";import{u as Z,a as G,U as f}from"./useUploadFile-C_PytDtH.js";import{C as V}from"./camera-Bzog6XsL.js";import{D as q,F as L}from"./file-spreadsheet-BK0EF4rr.js";function se({onEditTeamMember:g,onAddTeamMember:T}){const{data:h}=Y(),[U,x]=d.useState(!1),[i,F]=d.useState(null),M=W(),[P,b]=d.useState(!1),[n,N]=d.useState(null),B=Z(),H=G(),S=l=>{const o=["Dr. Emily Carter","Sarah Johnson","Mark Thompson"].includes(l);F({name:l,hasPhoto:o,photoUrl:o?{"Dr. Emily Carter":"https://images.unsplash.com/photo-1666886573230-2b730505f298?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxkb2N0b3IlMjBtZWRpY2FsJTIwcHJvZmVzc2lvbmFsfGVufDF8fHx8MTc1NTU3NTY5N3ww&ixlib=rb-4.1.0&q=80&w=400","Sarah Johnson":"https://images.unsplash.com/photo-1752649935791-46de93c304f5?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx0ZWFjaGVyJTIwZWR1Y2F0b3IlMjBwcm9mZXNzaW9uYWx8ZW58MXx8fHwxNzU1NTg0MDM5fDA&ixlib=rb-4.1.0&q=80&w=400","Mark Thompson":"https://images.unsplash.com/photo-1739298061757-7a3339cee982?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxwcm9mZXNzaW9uYWwlMjBoZWFkc2hvdCUyMGJ1c2luZXNzJTIwcGVyc29ufGVufDF8fHx8MTc1NTQ3NTEwMXww&ixlib=rb-4.1.0&q=80&w=400"}[l]:void 0})},E=l=>{const s=document.createElement("input");s.type="file",s.accept="image/*",s.style.display="none",s.onchange=o=>{var v;const r=(v=o.target.files)==null?void 0:v[0];r&&H.mutate({userId:l,file:r},{onSuccess:C=>{console.log("Uploaded:",C),x(!0),M.invalidateQueries({queryKey:["users"]})},onError:C=>{console.error("Upload failed",C)}})},document.body.appendChild(s),s.click(),document.body.removeChild(s)},w=()=>{const l=document.createElement("input");l.type="file",l.accept=".xlsx,.xls,.csv",l.style.display="none",l.onchange=s=>{var r;const o=(r=s.target.files)==null?void 0:r[0];o&&(N(o),console.log("Excel file uploaded:",o.name))},document.body.appendChild(l),l.click(),document.body.removeChild(l)},z=()=>{n&&(console.log("Processing bulk upload for file:",n.name),n&&B.mutate(n),N(null),b(!1))},J=l=>{if(l.role=="ct")return"CT";if(l.role=="teacher")return l.is_ct?"Team member/ CT":"Team member"},R=()=>{console.log("Downloading Excel template for bulk upload");const l=`Name,Age,Gender,ID Number,Specialization,Date of Joining,Class,Role,Email,DOB
John Doe,25,Male,TM001,Speech Therapy,2024-01-15,Class A,Team member,john@awwa.org,1999-03-15
Jane Smith,30,Female,CT001,Occupational Therapy,2023-08-20,Class B,CT,jane@awwa.org,1994-07-22
Michael Tan,28,Male,TMCT001,Physiotherapy,2024-05-12,Class A,Team member/CT,michael@awwa.org,1996-11-03`,s=new Blob([l],{type:"text/csv"}),o=window.URL.createObjectURL(s),r=document.createElement("a");r.href=o,r.download="team_members_template.csv",r.click(),window.URL.revokeObjectURL(o)};return e.jsx("div",{className:"flex-1 px-6 py-8",style:{backgroundColor:"#F8F9FA"},children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6"}),e.jsx("h2",{className:"text-2xl font-bold mb-6",style:{color:"#3C3C3C"},children:"Team members/CT"}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-6",children:e.jsxs(I,{children:[e.jsx(O,{children:e.jsxs(k,{style:{backgroundColor:"#F8F9FA",borderColor:"#BDC3C7"},children:[e.jsx(a,{className:"text-center w-12",style:{color:"#3C3C3C"},children:"S"}),e.jsx(a,{style:{color:"#3C3C3C"},children:"Name"}),e.jsx(a,{className:"text-center",style:{color:"#3C3C3C"},children:"Age (Yr)"}),e.jsx(a,{className:"text-center",style:{color:"#3C3C3C"},children:"Gender"}),e.jsx(a,{className:"text-center",style:{color:"#3C3C3C"},children:"ID"}),e.jsx(a,{style:{color:"#3C3C3C"},children:"Specialization"}),e.jsx(a,{style:{color:"#3C3C3C"},children:"Date of Joining"}),e.jsx(a,{style:{color:"#3C3C3C"},children:"Class"}),e.jsx(a,{style:{color:"#3C3C3C"},children:"Role"}),e.jsx(a,{className:"text-center",style:{color:"#3C3C3C"},children:"Photo"}),e.jsx(a,{className:"text-center",style:{color:"#3C3C3C"},children:"Edit"})]})}),e.jsx(_,{children:h==null?void 0:h.map((l,s)=>e.jsxs(k,{style:{borderColor:"#BDC3C7",backgroundColor:"white"},children:[e.jsx(t,{className:"text-center",style:{color:"#3C3C3C"},children:s+1}),e.jsxs(t,{style:{color:"#3C3C3C"},children:[l.first_name," ",l.last_name]}),e.jsx(t,{className:"text-center",style:{color:"#3C3C3C"},children:l.age}),e.jsx(t,{className:"text-center",style:{color:"#3C3C3C"},children:l.gender}),e.jsx(t,{className:"text-center",style:{color:"#3C3C3C"},children:l.id_number}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.specialization}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.date_of_joining}),e.jsx(t,{style:{color:"#3C3C3C"},children:l.classes}),e.jsx(t,{style:{color:"#3C3C3C"},children:J(l)}),e.jsx(t,{className:"text-center",children:e.jsxs(m,{children:[e.jsx(D,{asChild:!0,children:e.jsx("button",{className:"w-10 h-8 border border-red-500 bg-red-50 flex items-center justify-center hover:bg-red-100 transition-colors rounded",onClick:()=>S(l.first_name),title:`View/Upload photo for ${l.first_name}`,children:e.jsx(V,{className:"w-4 h-4",style:{color:"#DC3545"}})})}),e.jsx(p,{className:"max-w-md mx-auto bg-white rounded-lg shadow-xl border-2 p-6",style:{borderColor:"#BDC3C7",backgroundColor:"white"},children:i&&e.jsxs(e.Fragment,{children:[e.jsxs(u,{className:"pb-4 text-left",children:[e.jsxs(j,{className:"text-lg font-bold",style:{color:"#3C3C3C"},children:[i.name," - Photo"]}),e.jsxs(y,{className:"text-sm mt-2",style:{color:"#6C757D"},children:["View the photo for ",i.name,". Click outside to close this dialog."]})]}),e.jsx("div",{className:"flex justify-center py-6",children:e.jsx("div",{className:"rounded-lg flex items-center justify-center overflow-hidden",style:{backgroundColor:"#E8F4F8"},children:l.photo?e.jsx("img",{src:l.photo,alt:`Photo of ${l.first_name}`,className:"max-w-full h-auto rounded-lg",style:{maxHeight:"300px",maxWidth:"300px"}},l.photo):e.jsx("img",{src:"/placeholder-user.png",alt:"No photo available",className:"max-w-full h-auto",style:{maxHeight:"300px"}})})}),e.jsxs("div",{className:"flex justify-center space-x-3 pt-4",children:[e.jsxs(c,{className:"px-4 py-2 rounded-lg transition-all duration-200 hover:opacity-90",onClick:()=>E(l.id),style:{backgroundColor:"#e65039",color:"white",border:"none"},children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Upload New Photo"]}),i.hasPhoto&&e.jsx(c,{variant:"outline",className:"px-4 py-2 rounded-lg border-2 transition-all duration-200 hover:opacity-90",style:{borderColor:"#DC3545",color:"#DC3545",backgroundColor:"white"},children:"Remove Photo"})]})]})})]})}),e.jsx(t,{className:"text-center",children:e.jsx("button",{onClick:()=>g&&g(l),className:"p-1 hover:bg-gray-100 rounded transition-colors",title:`Edit ${l.first_name}`,children:e.jsx(A,{className:"w-4 h-4",style:{color:"#3C3C3C"}})})})]},l.id))})]})}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsxs(m,{open:P,onOpenChange:b,children:[e.jsx(D,{asChild:!0,children:e.jsxs(c,{className:"flex items-center space-x-2 px-6 py-2 transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{children:"Upload"})]})}),e.jsxs(p,{className:"max-w-md",style:{backgroundColor:"white"},children:[e.jsxs(u,{children:[e.jsx(j,{className:"text-lg font-bold",style:{color:"#3C3C3C"},children:"Bulk Upload Team Members"}),e.jsx(y,{className:"text-sm",style:{color:"#6C757D"},children:"Upload multiple team members at once using an Excel file. Follow the two-step process below."})]}),e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",style:{color:"#3C3C3C"},children:"Step 1: Download Template"}),e.jsxs(c,{onClick:R,className:"w-full flex items-center space-x-2 border-2 px-4 py-2 transition-all duration-200 hover:bg-blue-50",style:{backgroundColor:"white",borderColor:"#e65039",color:"#e65039"},children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:"Download Excel Template"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",style:{color:"#3C3C3C"},children:"Step 2: Upload Completed File"}),n?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 border rounded-lg",style:{borderColor:"#BDC3C7",backgroundColor:"#F8F9FA"},children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5",style:{color:"#e65039"}}),e.jsx("span",{className:"text-sm font-medium",style:{color:"#3C3C3C"},children:n.name})]}),e.jsxs("p",{className:"text-xs mt-1",style:{color:"#6C757D"},children:[(n.size/1024).toFixed(1)," KB"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(c,{onClick:w,className:"flex-1 border-2 px-4 py-2 transition-all duration-200 hover:bg-blue-50",style:{backgroundColor:"white",borderColor:"#e65039",color:"#e65039"},children:"Change File"}),e.jsx(c,{onClick:z,className:"flex-1 px-4 py-2 transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:"Upload"})]})]}):e.jsxs(c,{onClick:w,className:"w-full border-2 border-dashed px-6 py-6 transition-all duration-200 hover:bg-blue-50 flex flex-col items-center justify-center space-y-3 min-h-[120px]",style:{backgroundColor:"white",borderColor:"#e65039",color:"#e65039"},children:[e.jsx(f,{className:"w-6 h-6 flex-shrink-0"}),e.jsxs("div",{className:"text-center space-y-1 max-w-full",children:[e.jsx("p",{className:"font-medium text-sm leading-tight",children:"Choose Excel File"}),e.jsx("p",{className:"text-xs leading-tight break-words",style:{color:"#6C757D"},children:"Supports .xlsx, .xls, .csv files"})]})]})]}),e.jsx("div",{className:"bg-yellow-100 p-3 border-l-4",style:{borderColor:"#FF8C42"},children:e.jsxs("p",{className:"text-xs",style:{color:"#3C3C3C"},children:[e.jsx("strong",{children:"Note:"})," The Excel file should contain columns for Name, Age, Gender, ID Number, Specialization, Date of Joining, Class, Role, Email, and DOB."]})})]})]})]}),e.jsx(m,{open:U,onOpenChange:x,children:e.jsxs(p,{className:"max-w-md bg-white rounded-lg border-2",style:{backgroundColor:"white",borderColor:"#BDC3C7"},children:[e.jsxs(u,{children:[e.jsx(j,{style:{color:"#3C3C3C"},children:"Photo Update"}),e.jsx(y,{style:{color:"#6C757D"},children:"Photo has been successfully updated."})]}),e.jsx("div",{className:"flex justify-end space-x-3 pt-2",children:e.jsx(c,{onClick:()=>x(!1),className:"px-4 py-2 border-2 transition-all duration-200",style:{backgroundColor:"white",borderColor:"#BDC3C7",color:"#3C3C3C"},children:"Ok"})})]})}),e.jsxs(c,{onClick:T,className:"flex items-center space-x-2 px-6 py-2 transition-all duration-200 hover:opacity-90",style:{backgroundColor:"#e65039",color:"white",border:"none"},children:[e.jsx(X,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Team Member / CT"})]})]})]})})}export{se as TeamMembersCTPage};
